"use strict";define("TFS/Admin/Common",["require","exports","VSS/Platform/Context","VSS/Platform/RestClientBase","VSS/Platform/Util/Serialization","VSS/Core/Util/String","VSS/Platform/Identity","react","VSS/Platform/Layout","VSSUI/Table","VSSUI/Utilities/Provider","VSSUI/Icon"],(function(e,t,r,i,s,n,o,a,c,u,p,l){var m,d,g,y,h,T,b;m=t[b="Resources"]={},t[b].OrganizationAlreadyLinked="This organization is already connected to a Microsoft Entra tenant. Disconnect it from the Microsoft Entra tenant before attempting to connect it to a different Microsoft Entra tenant.",t[b].OrganizationNotYetLinked="This organization is not connected with a Microsoft Entra tenant. It must be connected before attempting to disconnect it from a Microsoft Entra tenant.",t[b].ErrorOccurredPleaseTryAgain="An error occurred. Please refresh the page and try again.",t[b].UserNotAuthorized="The user is not authorized to access this resource. Please check with your organization admin for the action.",t[b].AadMapExistingMembershipError="We cannot map the current email to this identity because it is or has been a member of the Azure DevOps organization. Choose an identity that does not exist in the Azure DevOps organization.",t[b].AcyclicMember="TF50233: A cyclic group containment error occurred when adding a group member.",t[b].PV_NotSet="Not set",t[b].PV_Allow="Allow",t[b].PV_Deny="Deny",t[b].PV_InheritedAllow="Allow (inherited)",t[b].PV_InheritedDeny="Deny (inherited)",t[b].PV_AllowedBySystem="Allow (system)",t[b].PV_DeniedBySystem="Deny (system)",t[b].ErrorMessage_CyclicGroupContainment="TF50233: A cyclic group containment error occurred when adding a group member. The group {1} already has the group {0} as a contained member.",function(e){d=t[e]={},t[e].aadPrefix="aad",t[e].aadspPrefix="aadsp",t[e].TeamProjectDomainPrefix="vstfs:///Classification/TeamProject",function(e){e.User="user",e.Group="group",e.Custom="custom",e.Vsd="vsd"}(t[e].IEntityType||(t[e].IEntityType={})),function(e){e.OrganisationSettingsRouteId="ms.vss-admin-web.collection-admin-hub-route",e.ProjectSettingsRouteId="ms.vss-admin-web.project-admin-hub-route"}(t[e].Routes||(t[e].Routes={})),function(e){e.OrganisationGroups="groups",e.ProjectGroups="permissions",e.TeamGroups="teams"}(t[e].AdminHubViewKeys||(t[e].AdminHubViewKeys={})),function(e){e.AdminPivot="adminPivot",e.SubjectDescriptor="subjectDescriptor",e.Project="project"}(t[e].QueryParams||(t[e].QueryParams={})),t[e].ims="ims",t[e].aad="aad",t[e].source="source",t[e].user="user",t[e].group="group",t[e].servicePrincipal="servicePrincipal",t[e].aadGroup="aadGroup",t[e].minResults=5,t[e].maxResults=20,t[e].defaultIndex=0,t[e].firstIndex=1,function(e){e[e.Success=0]="Success",e[e.Partial=1]="Partial",e[e.Failed=2]="Failed"}(t[e].Result||(t[e].Result={}))}("ConstantsConstants"),function(e){g=t[e]={},function(e){e.CollectionAlreadyLinked="already linked",e.UnexpectedJsonToken="Unexpected token",e.JsonParseError="JSON.parse",e.CollectionNotLinked="not yet linked",e.IdentityMaterializationFailure="VS403283:",e.UserNeedsSignIn="TF401444:",e.UserNotAuthorized="TF400813:",e.NetworkConnectionError="TF400893:",e.MicrosoftEmailAddress="VS850039:",e.MoreThanOneCollection="VS850043:",e.ExistingMembership="active or inactive memberships",e.NodeDuplicateName="VS402371",e.AadAccessSilentException="AadAccessSilentException",e.AcyclicMember="TF50233"}(t[e].CustomErrorSearchString||(t[e].CustomErrorSearchString={}))}("ConstantsCustomErrorConstants"),function(e){t[e]={},function(e){e.InitPermissionsView="InitializePermissionView",e.TenantId="/TenantId",e.OrganizationRestClient="Organization-AdminArea.IOrganizationRestClient",e.Me="Me",e.OwnerPath="/Owner",e.TimeZonePath="/SystemProperty.TimeZone",e.DescriptionPath="/SystemProperty.Description",e.PrivacyUrlPath="/SystemProperty.PrivacyUrl",e.NamePath="/Name",e.InitGroupsView="InitializeGroupsView",e.FetchPermissionsGroups="FetchPermissionsGroups",e.SetDefaultTeam="SetDefaultTeam",e.CreateTeam="CreateTeam",e.SetTeamAdmins="SetTeamAdmins",e.RemoveTeamAdmin="RemoveTeamAdmin",e.SetAreaPath="SetAreaPath"}(t[e].DataProviders||(t[e].DataProviders={}))}("ConstantsDataProviderConstants"),function(e){t[e]={},function(e){e.Namespace="TenantPolicy",e.OrganizationCreationRestriction="TenantPolicy.OrganizationCreationRestriction",e.RestrictGlobalPersonalAccessToken="TenantPolicy.RestrictGlobalPersonalAccessToken",e.RestrictFullScopePersonalAccessToken="TenantPolicy.RestrictFullScopePersonalAccessToken",e.RestrictPersonalAccessTokenLifespan="TenantPolicy.RestrictPersonalAccessTokenLifespan",e.EnableLeakedPersonalAccessTokenAutoRevocation="TenantPolicy.EnableLeakedPersonalAccessTokenAutoRevocation",e.RestrictLargeGroups="TenantPolicy.RestrictLargeGroups",e.AzureArtifactsCrossTenantUpstreams="TenantPolicy.AzureArtifactsCrossTenantUpstreams"}(t[e].PolicyNames||(t[e].PolicyNames={})),function(e){e.AllowedUsersAndGroupObjectIds="AllowedUsersAndGroupObjectIds",e.MaxPatLifespanInDays="MaxPatLifespanInDays",e.ErrorMessage="ErrorMessage",e.RestrictedGroupsObjectIds="RestrictedGroupsObjectIds",e.AllowedTenants="AllowedTenants"}(t[e].PolicyProperties||(t[e].PolicyProperties={}))}("ConstantsGeneratedConstants"),function(e){y=t[e]={},function(e){e.Admin="Admin"}(t[e].Area||(t[e].Area={})),function(e){e.ProjectOverview="ProjectOverview",e.OrganizationPermissions="OrganizationPermissions",e.OrganizationOverview="OrganizationOverview",e.OrganizationProjects="OrganizationProjects",e.OrganizationAad="OrganizationAad",e.ProjectOverviewAdmins="ProjectOverviewAdmins",e.ProfileAboutView="ProfileAboutView",e.ProfilePreferences="ProfilePreferences",e.ProfileTheme="ProfileTheme",e.ProfileRefreshPermissions="ProfileRefreshPermissions",e.GitHubConnection="GitHubConnection",e.SSHPublicKeys="SSHPublicKeys",e.Authorizations="Authorizations",e.OrganizationGroups="OrganizationGroups",e.ProjectPermissions="ProjectPermissions",e.ProjectGroups="ProjectGroups",e.SettingsPivot="SettingsPivot",e.AdminDefault="Admin",e.Teams="Teams",e.ResourceSecurity="ResourceSecurity",e.SettingsSearch="SettingsSearch",e.OrganizationPolicies="OrganizationPolicies",e.ProjectDashboards="ProjectDashboards",e.ProfileOrganizations="ProfileOrganizations"}(t[e].Feature||(t[e].Feature={})),function(e){e.AccessDenied="Access Denied",e.UserNotAuthorized="TF400813",e.UserNeedsSignIn="TF401444",e.UserCouldNotBeAdded="Could not add user",e.UpnPresent="@",e.ActiveMemberNotAllowed="Only active members",e.IdentityMaterializationFailure="VS403283",e.AccountInsufficientPermission="TF50309"}(t[e].ErrorMessageSearchString||(t[e].ErrorMessageSearchString={})),function(e){e.AccessDenied="The current user does not have the required permissions to perform that action.",e.UserNotAuthorized="The current user is not authorized to access this resource.",e.UserNeedsSignIn="The user needs to sign in at least once to access this service.",e.UserCouldNotBeAdded="Could not add user into tenant.",e.UpnPresent="Error message contains email address. Please see ProductTrace.",e.ActiveMemberNotAllowed="Only active members of the AAD tenant are allowed to perform the link.",e.IdentityMaterializationFailure="Could not add user at this time.",e.AccountInsufficientPermission="Account does not have sufficient permissions to complete the operation. More perrmissions are needed to perform this operation."}(t[e].ErrorMessageReturnString||(t[e].ErrorMessageReturnString={})),function(e){e.Action="Action",e.SubFeature="SubFeature",e.ErrorMessage="ErrorMessage",e.PageUrl="PageUrl"}(t[e].TelemetryProperties||(t[e].TelemetryProperties={})),function(e){e[e.SecurityPanel=0]="SecurityPanel",e[e.SecurityMembers=1]="SecurityMembers",e[e.SecurityPermissions=2]="SecurityPermissions"}(t[e].ResourceSecurityComponent||(t[e].ResourceSecurityComponent={})),function(e){e.LoadSecurityModel="LoadSecurityModel",e.LoadMembersData="LoadMembersData",e.LoadSecurityPermissionsData="LoadSecurityPermissionsData"}(t[e].PerformanceScenarios||(t[e].PerformanceScenarios={}))}("ConstantsTelemetryConstants"),t.ContractsCustomIdentityRef={},t.ContractsIOrganizationIdentity={},function(e){t[e]={};class s extends i.RestClientBase{constructor(e){super(e)}async getCollectionsByTenantId(e){const t={tenantId:e};return this.beginRequest({apiVersion:"5.2-preview.1",httpResponseType:"application/octet-stream",routeTemplate:"_apis/EnterpriseCatalog/Organizations",queryParams:t})}}t[e].EnterpriseCatalogClientName="IEnterpriseCatalogRestClient",t[e].getEnterpriseCatalogClient=function(r,i){return r.getRestClient(t[e].EnterpriseCatalogClientName,i)},r.RestClients.add(t[e].EnterpriseCatalogClientName,{factory:s,options:{serviceInstanceType:"00000041-0000-8888-8000-000000000000"}})}("RestClientEnterpriseCatalog"),function(e){t[e]={};class n extends i.RestClientBase{constructor(e){super(e)}async deleteAvatar(e){return this.beginRequest({apiVersion:"7.1-preview.1",method:"DELETE",routeTemplate:"_apis/Graph/Subjects/{subjectDescriptor}/Avatars",routeValues:{subjectDescriptor:e}})}async getAvatar(e,t,r){const i={size:t,format:r};return this.beginRequest({apiVersion:"7.1-preview.1",routeTemplate:"_apis/Graph/Subjects/{subjectDescriptor}/Avatars",routeValues:{subjectDescriptor:e},queryParams:i})}async setAvatar(e,t){return this.beginRequest({apiVersion:"7.1-preview.1",method:"PUT",routeTemplate:"_apis/Graph/Subjects/{subjectDescriptor}/Avatars",routeValues:{subjectDescriptor:t},body:e})}async getCachePolicies(){return this.beginRequest({apiVersion:"7.1-preview.1",routeTemplate:"_apis/Graph/CachePolicies"})}async getDescriptor(e){return this.beginRequest({apiVersion:"7.1-preview.1",routeTemplate:"_apis/Graph/Descriptors/{storageKey}",routeValues:{storageKey:e}})}async getFederatedProviderData(e,t,r){const i={providerName:t,versionHint:r};return this.beginRequest({apiVersion:"7.1-preview.1",routeTemplate:"_apis/Graph/FederatedProviderData/{subjectDescriptor}",routeValues:{subjectDescriptor:e},queryParams:i})}async createGroup(e,t,r){const i={scopeDescriptor:t,groupDescriptors:r&&r.join(",")};return this.beginRequest({apiVersion:"7.1-preview.1",method:"POST",routeTemplate:"_apis/Graph/Groups/{groupDescriptor}",queryParams:i,body:e})}async deleteGroup(e){return this.beginRequest({apiVersion:"7.1-preview.1",method:"DELETE",routeTemplate:"_apis/Graph/Groups/{groupDescriptor}",routeValues:{groupDescriptor:e}})}async getGroup(e){return this.beginRequest({apiVersion:"7.1-preview.1",routeTemplate:"_apis/Graph/Groups/{groupDescriptor}",routeValues:{groupDescriptor:e}})}async listGroups(e,t,r){const i={scopeDescriptor:e,subjectTypes:t&&t.join(","),continuationToken:r};return this.beginRequest({apiVersion:"7.1-preview.1",routeTemplate:"_apis/Graph/Groups/{groupDescriptor}",queryParams:i,returnRawResponse:!0}).then((async e=>{const t=await e.text().then(s.deserializeVssJsonObject),r=e.headers.get("X-MS-ContinuationToken");return{graphGroups:t,continuationToken:r?r.split(","):[]}}))}async updateGroup(e,t){return this.beginRequest({apiVersion:"7.1-preview.1",method:"PATCH",routeTemplate:"_apis/Graph/Groups/{groupDescriptor}",routeValues:{groupDescriptor:e},customHeaders:{"Content-Type":"application/json-patch+json"},body:t})}async translate(e,t){const r={masterId:e,localId:t};return this.beginRequest({apiVersion:"7.1-preview.1",routeTemplate:"_apis/Graph/IdentityTranslation",queryParams:r})}async lookupMembers(e){return this.beginRequest({apiVersion:"7.1-preview.1",method:"POST",routeTemplate:"_apis/Graph/MemberLookup",body:e})}async listMembers(e,t,r,i,n){const o={continuationToken:e,subjectTypes:t&&t.join(","),subjectKinds:r&&r.join(","),metaTypes:i&&i.join(","),scopeDescriptor:n};return this.beginRequest({apiVersion:"7.1-preview.2",routeTemplate:"_apis/Graph/Members",queryParams:o,returnRawResponse:!0}).then((async e=>{const t=await e.text().then(s.deserializeVssJsonObject),r=e.headers.get("X-MS-ContinuationToken");return{graphMembers:t,continuationToken:r?r.split(","):[]}}))}async getMemberByDescriptor(e){return this.beginRequest({apiVersion:"7.1-preview.2",routeTemplate:"_apis/Graph/Members/{memberDescriptor}",routeValues:{memberDescriptor:e}})}async addMembership(e,t){return this.beginRequest({apiVersion:"7.1-preview.1",method:"PUT",routeTemplate:"_apis/Graph/Memberships/{subjectDescriptor}/{containerDescriptor}",routeValues:{subjectDescriptor:e,containerDescriptor:t}})}async checkMembershipExistence(e,t){return this.beginRequest({apiVersion:"7.1-preview.1",method:"HEAD",routeTemplate:"_apis/Graph/Memberships/{subjectDescriptor}/{containerDescriptor}",routeValues:{subjectDescriptor:e,containerDescriptor:t},returnRawResponse:!0}).then((async e=>!0)).catch((e=>{if(404===e.status)return!1;throw e}))}async getMembership(e,t){return this.beginRequest({apiVersion:"7.1-preview.1",routeTemplate:"_apis/Graph/Memberships/{subjectDescriptor}/{containerDescriptor}",routeValues:{subjectDescriptor:e,containerDescriptor:t}})}async removeMembership(e,t){return this.beginRequest({apiVersion:"7.1-preview.1",method:"DELETE",routeTemplate:"_apis/Graph/Memberships/{subjectDescriptor}/{containerDescriptor}",routeValues:{subjectDescriptor:e,containerDescriptor:t}})}async listMemberships(e,t,r){const i={direction:t,depth:r};return this.beginRequest({apiVersion:"7.1-preview.1",routeTemplate:"_apis/Graph/Memberships/{subjectDescriptor}",routeValues:{subjectDescriptor:e},queryParams:i})}async getMembershipState(e){return this.beginRequest({apiVersion:"7.1-preview.1",routeTemplate:"_apis/Graph/MembershipStates/{subjectDescriptor}",routeValues:{subjectDescriptor:e}})}async lookupMembershipTraversals(e,t,r){const i={direction:t,depth:r};return this.beginRequest({apiVersion:"7.1-preview.1",method:"POST",routeTemplate:"_apis/Graph/MembershipTraversals/{subjectDescriptor}",queryParams:i,body:e})}async traverseMemberships(e,t,r){const i={direction:t,depth:r};return this.beginRequest({apiVersion:"7.1-preview.1",routeTemplate:"_apis/Graph/MembershipTraversals/{subjectDescriptor}",routeValues:{subjectDescriptor:e},queryParams:i})}async getProviderInfo(e){return this.beginRequest({apiVersion:"7.1-preview.1",routeTemplate:"_apis/Graph/Users/{userDescriptor}/ProviderInfo",routeValues:{userDescriptor:e}})}async requestAccess(e){return this.beginRequest({apiVersion:"7.1-preview.1",method:"POST",routeTemplate:"_apis/Graph/RequestAccess",body:e})}async resolve(e){return this.beginRequest({apiVersion:"7.1-preview.1",method:"POST",routeTemplate:"_apis/Graph/ResolveDisconnectedUsers",body:e})}async createScope(e,t){return this.beginRequest({apiVersion:"7.1-preview.1",method:"POST",routeTemplate:"_apis/Graph/Scopes/{scopeDescriptor}",routeValues:{scopeDescriptor:t},body:e})}async deleteScope(e){return this.beginRequest({apiVersion:"7.1-preview.1",method:"DELETE",routeTemplate:"_apis/Graph/Scopes/{scopeDescriptor}",routeValues:{scopeDescriptor:e}})}async getScope(e){return this.beginRequest({apiVersion:"7.1-preview.1",routeTemplate:"_apis/Graph/Scopes/{scopeDescriptor}",routeValues:{scopeDescriptor:e}})}async updateScope(e,t){return this.beginRequest({apiVersion:"7.1-preview.1",method:"PATCH",routeTemplate:"_apis/Graph/Scopes/{scopeDescriptor}",routeValues:{scopeDescriptor:e},customHeaders:{"Content-Type":"application/json-patch+json"},body:t})}async createServicePrincipal(e,t){const r={groupDescriptors:t&&t.join(",")};return this.beginRequest({apiVersion:"7.1-preview.1",method:"POST",routeTemplate:"_apis/Graph/ServicePrincipals/{servicePrincipalDescriptor}",queryParams:r,body:e})}async deleteServicePrincipal(e){return this.beginRequest({apiVersion:"7.1-preview.1",method:"DELETE",routeTemplate:"_apis/Graph/ServicePrincipals/{servicePrincipalDescriptor}",routeValues:{servicePrincipalDescriptor:e}})}async getServicePrincipal(e){return this.beginRequest({apiVersion:"7.1-preview.1",routeTemplate:"_apis/Graph/ServicePrincipals/{servicePrincipalDescriptor}",routeValues:{servicePrincipalDescriptor:e}})}async listServicePrincipals(e,t){const r={continuationToken:e,scopeDescriptor:t};return this.beginRequest({apiVersion:"7.1-preview.1",routeTemplate:"_apis/Graph/ServicePrincipals/{servicePrincipalDescriptor}",queryParams:r,returnRawResponse:!0}).then((async e=>{const t=await e.text().then(s.deserializeVssJsonObject),r=e.headers.get("X-MS-ContinuationToken");return{graphServicePrincipals:t,continuationToken:r?r.split(","):[]}}))}async updateServicePrincipal(e,t){return this.beginRequest({apiVersion:"7.1-preview.1",method:"PATCH",routeTemplate:"_apis/Graph/ServicePrincipals/{servicePrincipalDescriptor}",routeValues:{servicePrincipalDescriptor:t},body:e})}async getStorageKey(e){return this.beginRequest({apiVersion:"7.1-preview.1",routeTemplate:"_apis/Graph/StorageKeys/{subjectDescriptor}",routeValues:{subjectDescriptor:e}})}async lookupSubjects(e){return this.beginRequest({apiVersion:"7.1-preview.1",method:"POST",routeTemplate:"_apis/Graph/SubjectLookup",body:e})}async querySubjects(e){return this.beginRequest({apiVersion:"7.1-preview.1",method:"POST",routeTemplate:"_apis/Graph/SubjectQuery",body:e})}async getSubject(e){return this.beginRequest({apiVersion:"7.1-preview.1",routeTemplate:"_apis/Graph/Subjects/{subjectDescriptor}",routeValues:{subjectDescriptor:e}})}async createUser(e,t){const r={groupDescriptors:t&&t.join(",")};return this.beginRequest({apiVersion:"7.1-preview.1",method:"POST",routeTemplate:"_apis/Graph/Users/{userDescriptor}",queryParams:r,body:e})}async deleteUser(e){return this.beginRequest({apiVersion:"7.1-preview.1",method:"DELETE",routeTemplate:"_apis/Graph/Users/{userDescriptor}",routeValues:{userDescriptor:e}})}async getUser(e){return this.beginRequest({apiVersion:"7.1-preview.1",routeTemplate:"_apis/Graph/Users/{userDescriptor}",routeValues:{userDescriptor:e}})}async listUsers(e,t,r){const i={subjectTypes:e&&e.join(","),continuationToken:t,scopeDescriptor:r};return this.beginRequest({apiVersion:"7.1-preview.1",routeTemplate:"_apis/Graph/Users/{userDescriptor}",queryParams:i,returnRawResponse:!0}).then((async e=>{const t=await e.text().then(s.deserializeVssJsonObject),r=e.headers.get("X-MS-ContinuationToken");return{graphUsers:t,continuationToken:r?r.split(","):[]}}))}async updateUser(e,t){return this.beginRequest({apiVersion:"7.1-preview.1",method:"PATCH",routeTemplate:"_apis/Graph/Users/{userDescriptor}",routeValues:{userDescriptor:t},body:e})}}t[e].GraphClientName="IGraphRestClient",t[e].getGraphClient=function(r,i){return r.getRestClient(t[e].GraphClientName,i)},r.RestClients.add(t[e].GraphClientName,{factory:n,options:{resourceAreaId:"bb1e7ec9-e901-4b68-999a-de7012b920f8",serviceInstanceType:"951917ac-a960-4999-8464-e3f0aa25b381"}})}("RestClientGraph"),function(e){t[e]={};class s extends i.RestClientBase{constructor(e){super(e)}async createCollection(e,t,r,i){const s={collectionName:t,preferredRegion:r,ownerDescriptor:i};return this.beginRequest({apiVersion:"5.0-preview.2",method:"POST",routeTemplate:"_apis/HostAcquisition/Collections",queryParams:s,body:e})}async getNameAvailability(e){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/HostAcquisition/NameAvailability/{name}",routeValues:{name:e}})}async getRegions(){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/HostAcquisition/Regions"})}}t[e].HostAcquisitionClientName="Organization-Admin.IHostAcquisitionRestClient",t[e].getHostAcquisitionClient=function(r,i){return r.getRestClient(t[e].HostAcquisitionClientName,i)},r.RestClients.add(t[e].HostAcquisitionClientName,{factory:s,options:{serviceInstanceType:"00000041-0000-8888-8000-000000000000"}})}("RestClientHostAcquisition"),function(e){t[e]={};class n extends i.RestClientBase{constructor(e){super(e)}async createOrBindWithClaims(e){return this.beginRequest({apiVersion:"6.1-preview.1",method:"PUT",routeTemplate:"_apis/identities/Claims",body:e})}async getDescriptorById(e,t){const r={isMasterId:t};return this.beginRequest({apiVersion:"6.1-preview.1",routeTemplate:"_apis/identities/descriptors/{id}",routeValues:{id:e},queryParams:r})}async createGroups(e){return this.beginRequest({apiVersion:"6.1-preview.1",method:"POST",routeTemplate:"_apis/Groups/{groupId}",body:e})}async deleteGroup(e){return this.beginRequest({apiVersion:"6.1-preview.1",method:"DELETE",routeTemplate:"_apis/Groups/{groupId}",routeValues:{groupId:e}})}async listGroups(e,t,r,i){const s={scopeIds:e,recurse:t,deleted:r,properties:i};return this.beginRequest({apiVersion:"6.1-preview.1",routeTemplate:"_apis/Groups/{groupId}",queryParams:s})}async getIdentityChanges(e,t,r,i,s){const n={identitySequenceId:e,groupSequenceId:t,organizationIdentitySequenceId:r,pageSize:i,scopeId:s};return this.beginRequest({apiVersion:"6.1-preview.1",routeTemplate:"_apis/Identities/{identityId}",queryParams:n})}async getUserIdentityIdsByDomainId(e){const t={domainId:e};return this.beginRequest({apiVersion:"6.1-preview.1",routeTemplate:"_apis/Identities/{identityId}",queryParams:t})}async readIdentities(e,t,r,i,s,n,o,a,c,u){const p={descriptors:e,identityIds:t,subjectDescriptors:r,socialDescriptors:i,searchFilter:s,filterValue:n,queryMembership:o,properties:a,includeRestrictedVisibility:c,options:u};return this.beginRequest({apiVersion:"6.1-preview.1",routeTemplate:"_apis/Identities/{identityId}",queryParams:p})}async readIdentitiesByScope(e,t,r){const i={scopeId:e,queryMembership:t,properties:r};return this.beginRequest({apiVersion:"6.1-preview.1",routeTemplate:"_apis/Identities/{identityId}",queryParams:i})}async readIdentity(e,t,r){const i={queryMembership:t,properties:r};return this.beginRequest({apiVersion:"6.1-preview.1",routeTemplate:"_apis/Identities/{identityId}",routeValues:{identityId:e},queryParams:i})}async updateIdentities(e,t){const r={allowMetaDataUpdate:t};return this.beginRequest({apiVersion:"6.1-preview.1",method:"PUT",routeTemplate:"_apis/Identities/{identityId}",queryParams:r,body:e})}async updateIdentity(e,t){return this.beginRequest({apiVersion:"6.1-preview.1",method:"PUT",routeTemplate:"_apis/Identities/{identityId}",routeValues:{identityId:t},body:e})}async createIdentity(e){return this.beginRequest({apiVersion:"6.1-preview.1",method:"PUT",routeTemplate:"_apis/identities/Identity",body:e})}async readIdentityBatch(e){return this.beginRequest({apiVersion:"6.1-preview.1",method:"POST",routeTemplate:"_apis/IdentityBatch",body:e})}async getIdentitySnapshot(e){return this.beginRequest({apiVersion:"6.1-preview.1",routeTemplate:"_apis/IdentitySnapshot/{scopeId}",routeValues:{scopeId:e}})}async getMaxSequenceId(){return this.beginRequest({apiVersion:"6.1-preview.1",routeTemplate:"_apis/identities/MaxSequenceId"})}async getSelf(){return this.beginRequest({apiVersion:"6.1-preview.1",routeTemplate:"_apis/identities/me"})}async addMember(e,t){return this.beginRequest({apiVersion:"6.1-preview.1",method:"PUT",routeTemplate:"_apis/identities/{containerId}/Members/{memberId}",routeValues:{containerId:e,memberId:t}})}async forceRemoveMember(e,t,r){const i={forceRemove:r};return this.beginRequest({apiVersion:"6.1-preview.1",method:"DELETE",routeTemplate:"_apis/identities/{containerId}/Members/{memberId}",routeValues:{containerId:e,memberId:t},queryParams:i})}async readMember(e,t,r){const i={queryMembership:r};return this.beginRequest({apiVersion:"6.1-preview.1",routeTemplate:"_apis/identities/{containerId}/Members/{memberId}",routeValues:{containerId:e,memberId:t},queryParams:i})}async readMembers(e,t){const r={queryMembership:t};return this.beginRequest({apiVersion:"6.1-preview.1",routeTemplate:"_apis/identities/{containerId}/Members/{memberId}",routeValues:{containerId:e},queryParams:r})}async removeMember(e,t){return this.beginRequest({apiVersion:"6.1-preview.1",method:"DELETE",routeTemplate:"_apis/identities/{containerId}/Members/{memberId}",routeValues:{containerId:e,memberId:t}})}async readMemberOf(e,t,r){const i={queryMembership:r};return this.beginRequest({apiVersion:"6.1-preview.2",routeTemplate:"_apis/identities/{memberId}/MembersOf/{containerId}",routeValues:{memberId:e,containerId:t},queryParams:i})}async readMembersOf(e,t){const r={queryMembership:t};return this.beginRequest({apiVersion:"6.1-preview.2",routeTemplate:"_apis/identities/{memberId}/MembersOf/{containerId}",routeValues:{memberId:e},queryParams:r})}async refreshMembersOf(e,t){const r={queryMembership:t};return this.beginRequest({apiVersion:"6.1-preview.2",method:"POST",routeTemplate:"_apis/identities/{memberId}/MembersOf/{containerId}",routeValues:{memberId:e},queryParams:r})}async transferIdentityRightsBatch(e){return this.beginRequest({apiVersion:"6.1-preview.1",method:"POST",routeTemplate:"_apis/identities/Rights",body:e})}async createScope(e,t){return this.beginRequest({apiVersion:"6.1-preview.2",method:"PUT",routeTemplate:"_apis/Scopes/{scopeId}",routeValues:{scopeId:t},body:e})}async deleteScope(e){return this.beginRequest({apiVersion:"6.1-preview.2",method:"DELETE",routeTemplate:"_apis/Scopes/{scopeId}",routeValues:{scopeId:e}})}async getScopeById(e){return this.beginRequest({apiVersion:"6.1-preview.2",routeTemplate:"_apis/Scopes/{scopeId}",routeValues:{scopeId:e}})}async getScopeByName(e){const t={scopeName:e};return this.beginRequest({apiVersion:"6.1-preview.2",routeTemplate:"_apis/Scopes/{scopeId}",queryParams:t})}async updateScope(e,t){return this.beginRequest({apiVersion:"6.1-preview.2",method:"PATCH",routeTemplate:"_apis/Scopes/{scopeId}",routeValues:{scopeId:t},customHeaders:{"Content-Type":"application/json-patch+json"},body:e})}async getSignedInToken(){return this.beginRequest({apiVersion:"6.1-preview.1",routeTemplate:"_apis/SignedInToken"})}async getSignoutToken(){return this.beginRequest({apiVersion:"6.1-preview.1",routeTemplate:"_apis/SignoutToken"})}async swapIdentity(e){return this.beginRequest({apiVersion:"6.1-preview.1",method:"POST",routeTemplate:"_apis/identities/Swap",body:e})}async getTenant(e){return this.beginRequest({apiVersion:"6.1-preview.1",routeTemplate:"_apis/identities/tenant/{tenantId}",routeValues:{tenantId:e}})}async listUsers(e,t){const r={continuationToken:e,scopeDescriptor:t};return this.beginRequest({apiVersion:"6.1-preview.1",routeTemplate:"_apis/identities/Users",queryParams:r,returnRawResponse:!0}).then((async e=>{const t=await e.text().then(s.deserializeVssJsonObject),r=e.headers.get("X-MS-ContinuationToken");return{identities:t,continuationToken:r?r.split(","):[]}}))}}t[e].IdentitiesClientName="Identities-AdminArea.IIdentitiesRestClient",t[e].getIdentitiesClient=function(r,i){return r.getRestClient(t[e].IdentitiesClientName,i)},r.RestClients.add(t[e].IdentitiesClientName,{factory:n,options:{serviceInstanceType:"951917ac-a960-4999-8464-e3f0aa25b381"}})}("RestClientIdentities"),function(e){t[e]={};class s extends i.RestClientBase{constructor(e){super(e)}async sendInvitation(e,t){return this.beginRequest({apiVersion:"5.1-preview.1",method:"PUT",routeTemplate:"_apis/Invitations/{userId}",routeValues:{userId:t},body:e})}async sendInvitations(e){return this.beginRequest({apiVersion:"5.1-preview.1",method:"POST",routeTemplate:"_apis/Invitations/{userId}",body:e})}}t[e].InvitationClientName="IInvitationRestClient",t[e].getInvitationClient=function(r,i){return r.getRestClient(t[e].InvitationClientName,i)},r.RestClients.add(t[e].InvitationClientName,{factory:s,options:{serviceInstanceType:"951917ac-a960-4999-8464-e3f0aa25b381"}})}("RestClientInvitation"),function(e){t[e]={};class s extends i.RestClientBase{constructor(e){super(e)}async getContactWithOffers(e){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{descriptor}/ContactWithOffers",routeValues:{descriptor:e}})}async setContactWithOffers(e,t){const r={value:t};return this.beginRequest({apiVersion:"5.0-preview.1",method:"PUT",routeTemplate:"{descriptor}/ContactWithOffers",routeValues:{descriptor:e},queryParams:r})}async getMarketingPreferences(e){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{descriptor}/MarketingPreferences",routeValues:{descriptor:e}})}async setMarketingPreferences(e,t){return this.beginRequest({apiVersion:"5.0-preview.1",method:"PUT",routeTemplate:"{descriptor}/MarketingPreferences",routeValues:{descriptor:t},body:e})}}t[e].MarketingPreferencesClientName="IMarketingPreferencesRestClient",t[e].getMarketingPreferencesClient=function(r,i){return r.getRestClient(t[e].MarketingPreferencesClientName,i)},r.RestClients.add(t[e].MarketingPreferencesClientName,{factory:s,options:{serviceInstanceType:"00000038-0000-8888-8000-000000000000"}})}("RestClientMarketingPreferences"),function(e){t[e]={};class s extends i.RestClientBase{constructor(e){super(e)}async cancelRequest(e){return this.beginRequest({apiVersion:"5.0-preview.1",method:"DELETE",routeTemplate:"_apis/ServicingOrchestration/NewDomainUrlMigration/Requests/{requestId}",routeValues:{requestId:e}})}async getRequestStatus(e){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/ServicingOrchestration/NewDomainUrlMigration/Requests/{requestId}",routeValues:{requestId:e}})}async queueRequest(e){return this.beginRequest({apiVersion:"5.0-preview.1",method:"PUT",routeTemplate:"_apis/ServicingOrchestration/NewDomainUrlMigration/Requests/{requestId}",body:e})}async validateRequest(e){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"_apis/ServicingOrchestration/NewDomainUrlMigration/Requests/{requestId}",body:e})}}t[e].NewDomainUrlMigrationClientName="INewDomainUrlMigrationRestClient",t[e].getNewDomainUrlMigrationClient=function(r,i){return r.getRestClient(t[e].NewDomainUrlMigrationClientName,i)},r.RestClients.add(t[e].NewDomainUrlMigrationClientName,{factory:s,options:{serviceInstanceType:"951917ac-a960-4999-8464-e3f0aa25b381"}})}("RestClientNewDomainUrlMigration"),function(e){t[e]={};class s extends i.RestClientBase{constructor(e){super(e)}async getStatus(){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/NewDomainUrlOrchestration"})}async queueMigration(e){const t={codexDomainUrls:e};return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"_apis/NewDomainUrlOrchestration",queryParams:t})}}t[e].NewDomainUrlOrchestrationClientName="INewDomainUrlOrchestrationRestClient",t[e].getNewDomainUrlOrchestrationClient=function(r,i){return r.getRestClient(t[e].NewDomainUrlOrchestrationClientName,i)},r.RestClients.add(t[e].NewDomainUrlOrchestrationClientName,{factory:s,options:{serviceInstanceType:"951917ac-a960-4999-8464-e3f0aa25b381"}})}("RestClientNewDomainUrlOrchestration"),function(e){t[e]={};class s extends i.RestClientBase{constructor(e){super(e)}async getOperation(e,t){const r={pluginId:t};return this.beginRequest({apiVersion:"4.1-preview.1",routeTemplate:"_apis/operations/{operationId}",routeValues:{operationId:e},queryParams:r})}}t[e].OperationsClientName="IOperationsRestClient",t[e].getOperationsClient=function(r,i){return r.getRestClient(t[e].OperationsClientName,i)},r.RestClients.add(t[e].OperationsClientName,{factory:s})}("RestClientOperations"),function(e){t[e]={};class s extends i.RestClientBase{constructor(e){super(e)}async deleteCollectionAvatar(e){return this.beginRequest({apiVersion:"7.2-preview.1",method:"DELETE",routeTemplate:"_apis/Organization/Collections/{collectionId}/Avatar",routeValues:{collectionId:e}})}async updateCollectionAvatar(e,t){return this.beginRequest({apiVersion:"7.2-preview.1",method:"PUT",routeTemplate:"_apis/Organization/Collections/{collectionId}/Avatar",routeValues:{collectionId:e},body:t})}async updateCollectionProperties(e,t){return this.beginRequest({apiVersion:"7.2-preview.1",method:"PATCH",routeTemplate:"_apis/Organization/Collections/{collectionId}/Properties",routeValues:{collectionId:e},customHeaders:{"Content-Type":"application/json-patch+json"},body:t})}async backfillPreferredGeography(e,t){const r={geographyName:t};return this.beginRequest({apiVersion:"7.2-preview.1",method:"PUT",routeTemplate:"_apis/Organization/Collections/{collectionId}",routeValues:{collectionId:e},queryParams:r})}async createCollection(e){return this.beginRequest({apiVersion:"7.2-preview.1",method:"POST",routeTemplate:"_apis/Organization/Collections/{collectionId}",body:e})}async deleteCollection(e,t,r){const i={gracePeriodToRestoreInHours:t,violatedTerms:r};return this.beginRequest({apiVersion:"7.2-preview.1",method:"DELETE",routeTemplate:"_apis/Organization/Collections/{collectionId}",routeValues:{collectionId:e},queryParams:i})}async forceUpdateCollectionOwner(e,t,r){const i={newOwner:r};return this.beginRequest({apiVersion:"7.2-preview.1",method:"POST",routeTemplate:"_apis/Organization/Collections/{collectionId}",routeValues:{collectionId:t},queryParams:i,body:e})}async getCollection(e,t){const r={propertyNames:t&&t.join(",")};return this.beginRequest({apiVersion:"7.2-preview.1",routeTemplate:"_apis/Organization/Collections/{collectionId}",routeValues:{collectionId:e},queryParams:r})}async getCollections(e,t,r){const i={searchKind:e,searchValue:t,includeDeletedCollections:r};return this.beginRequest({apiVersion:"7.2-preview.1",routeTemplate:"_apis/Organization/Collections/{collectionId}",queryParams:i})}async isEligibleForTakeOver(e){return this.beginRequest({apiVersion:"7.2-preview.1",method:"POST",routeTemplate:"_apis/Organization/Collections/{collectionId}",routeValues:{collectionId:e}})}async restoreCollection(e,t){const r={collectionName:t};return this.beginRequest({apiVersion:"7.2-preview.1",method:"PATCH",routeTemplate:"_apis/Organization/Collections/{collectionId}",routeValues:{collectionId:e},queryParams:r})}async updateCollection(e,t){return this.beginRequest({apiVersion:"7.2-preview.1",method:"PATCH",routeTemplate:"_apis/Organization/Collections/{collectionId}",routeValues:{collectionId:t},customHeaders:{"Content-Type":"application/json-patch+json"},body:e})}async getGeographies(){return this.beginRequest({apiVersion:"7.2-preview.1",routeTemplate:"_apis/Organization/Geographies"})}async exportOrganizationMigrationBlob(e){return this.beginRequest({apiVersion:"7.2-preview.1",routeTemplate:"_apis/Organization/OrganizationMigrationBlobs/{organizationId}",routeValues:{organizationId:e}})}async importOrganizationMigrationBlob(e){return this.beginRequest({apiVersion:"7.2-preview.1",method:"POST",routeTemplate:"_apis/Organization/OrganizationMigrationBlobs/{organizationId}",body:e})}async updateOrganizationProperties(e,t){return this.beginRequest({apiVersion:"7.2-preview.1",method:"PATCH",routeTemplate:"_apis/Organization/Organizations/{organizationId}/Properties",routeValues:{organizationId:e},customHeaders:{"Content-Type":"application/json-patch+json"},body:t})}async createOrganization(e){return this.beginRequest({apiVersion:"7.2-preview.1",method:"POST",routeTemplate:"_apis/Organization/Organizations/{organizationId}",body:e})}async getOldestOrganizationByTenant(e){const t={tenantId:e};return this.beginRequest({apiVersion:"7.2-preview.1",routeTemplate:"_apis/Organization/Organizations/{organizationId}",queryParams:t})}async getOrganization(e,t){const r={propertyNames:t&&t.join(",")};return this.beginRequest({apiVersion:"7.2-preview.1",routeTemplate:"_apis/Organization/Organizations/{organizationId}",routeValues:{organizationId:e},queryParams:r})}async getOrganizations(e,t,r){const i={searchKind:e,searchValue:t,isActivated:r};return this.beginRequest({apiVersion:"7.2-preview.1",routeTemplate:"_apis/Organization/Organizations/{organizationId}",queryParams:i})}async updateOrganization(e,t){return this.beginRequest({apiVersion:"7.2-preview.1",method:"PATCH",routeTemplate:"_apis/Organization/Organizations/{organizationId}",routeValues:{organizationId:t},customHeaders:{"Content-Type":"application/json-patch+json"},body:e})}async getRegions(e){const t={includeRegionsWithNoAvailableHosts:e};return this.beginRequest({apiVersion:"7.2-preview.1",routeTemplate:"_apis/Organization/Regions",queryParams:t})}}t[e].OrganizationClientName="Organization-AdminArea.IOrganizationRestClient",t[e].getOrganizationClient=function(r,i){return r.getRestClient(t[e].OrganizationClientName,i)},r.RestClients.add(t[e].OrganizationClientName,{factory:s,options:{serviceInstanceType:"951917ac-a960-4999-8464-e3f0aa25b381"}})}("RestClientOrganization"),function(e){t[e]={};class s extends i.RestClientBase{constructor(e){super(e)}async getPolicy(e,t){const r={defaultValue:t};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/OrganizationPolicy/Policies/{policyName}",routeValues:{policyName:e},queryParams:r})}async updatePolicy(e,t){return this.beginRequest({apiVersion:"5.0-preview.1",method:"PATCH",routeTemplate:"_apis/OrganizationPolicy/Policies/{policyName}",routeValues:{policyName:t},customHeaders:{"Content-Type":"application/json-patch+json"},body:e})}async getPolicies(e,t){const r={policyNames:e&&e.join(","),defaultValues:t&&t.join(",")};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/OrganizationPolicy/PoliciesBatch",queryParams:r})}async getPolicyInformation(e){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/OrganizationPolicy/PolicyInformation/{policyName}",routeValues:{policyName:e}})}async getPolicyInformations(e){const t={policyNames:e&&e.join(",")};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/OrganizationPolicy/PolicyInformation/{policyName}",queryParams:t})}}t[e].OrganizationPolicyClientName="OrganizationPolicy-Admin.IOrganizationPolicyRestClient",t[e].getOrganizationPolicyClient=function(r,i){return r.getRestClient(t[e].OrganizationPolicyClientName,i)},r.RestClients.add(t[e].OrganizationPolicyClientName,{factory:s})}("RestClientOrganizationPolicy"),function(e){t[e]={};class s extends i.RestClientBase{constructor(e){super(e)}async getDisconnectedUsers(e){const t={tenantId:e};return this.beginRequest({apiVersion:"5.1-preview.1",routeTemplate:"_apis/OrganizationSettings/DisconnectedUser",queryParams:t})}}t[e].OrganizationSettingsClientName="IOrganizationSettingsRestClient",t[e].getOrganizationSettingsClient=function(r,i){return r.getRestClient(t[e].OrganizationSettingsClientName,i)},r.RestClients.add(t[e].OrganizationSettingsClientName,{factory:s})}("RestClientOrganizationSettings"),function(e){t[e]={};class s extends i.RestClientBase{constructor(e){super(e)}async assignPermissionLevel(e,t,r){const i={definitionId:t,resourceId:r};return this.beginRequest({apiVersion:"5.1-preview.1",method:"POST",routeTemplate:"_apis/PermissionLevel/PermissionLevelAssignments/{subjectDescriptor}",routeValues:{subjectDescriptor:e},queryParams:i})}async getPermissionLevelAssignmentsByDefinitionId(e,t,r,i){const s={resourceId:e,definitionId:t,pageSize:r,continuationToken:i};return this.beginRequest({apiVersion:"5.1-preview.1",routeTemplate:"_apis/PermissionLevel/PermissionLevelAssignments/{subjectDescriptor}",queryParams:s})}async getPermissionLevelAssignmentsByScope(e,t,r,i){const s={resourceId:e,scope:t,pageSize:r,continuationToken:i};return this.beginRequest({apiVersion:"5.1-preview.1",routeTemplate:"_apis/PermissionLevel/PermissionLevelAssignments/{subjectDescriptor}",queryParams:s})}async getPermissionLevelAssignmentsByScopeAndSubject(e,t,r){const i={resourceId:t,scope:r};return this.beginRequest({apiVersion:"5.1-preview.1",routeTemplate:"_apis/PermissionLevel/PermissionLevelAssignments/{subjectDescriptor}",routeValues:{subjectDescriptor:e},queryParams:i})}async removePermissionLevelAssignment(e,t,r){const i={definitionId:t,resourceId:r};return this.beginRequest({apiVersion:"5.1-preview.1",method:"DELETE",routeTemplate:"_apis/PermissionLevel/PermissionLevelAssignments/{subjectDescriptor}",routeValues:{subjectDescriptor:e},queryParams:i})}async updatePermissionLevelAssignment(e,t,r,i){const s={resourceId:t,definitionId:r,newDefinitionId:i};return this.beginRequest({apiVersion:"5.1-preview.1",method:"PUT",routeTemplate:"_apis/PermissionLevel/PermissionLevelAssignments/{subjectDescriptor}",routeValues:{subjectDescriptor:e},queryParams:s})}async getPermissionLevelDefinitionsById(e){const t={definitionIds:e&&e.join(",")};return this.beginRequest({apiVersion:"5.1-preview.1",routeTemplate:"_apis/PermissionLevel/PermissionLevelDefinitions",queryParams:t})}async getPermissionLevelDefinitionsByScope(e,t){const r={definitionScope:e,definitionType:t};return this.beginRequest({apiVersion:"5.1-preview.1",routeTemplate:"_apis/PermissionLevel/PermissionLevelDefinitions",queryParams:r})}}t[e].PermissionLevelClientName="IPermissionLevelRestClient",t[e].getPermissionLevelClient=function(r,i){return r.getRestClient(t[e].PermissionLevelClientName,i)},r.RestClients.add(t[e].PermissionLevelClientName,{factory:s,options:{serviceInstanceType:"951917ac-a960-4999-8464-e3f0aa25b381"}})}("RestClientPermissionLevel"),function(e){t[e]={};class s extends i.RestClientBase{constructor(e){super(e)}async createPermissionsReport(e){return this.beginRequest({apiVersion:"5.2-preview.1",method:"POST",routeTemplate:"_apis/PermissionsReport/{id}",body:e})}async getPermissionsReport(e){return this.beginRequest({apiVersion:"5.2-preview.1",routeTemplate:"_apis/PermissionsReport/{id}",routeValues:{id:e}})}async getPermissionsReports(){return this.beginRequest({apiVersion:"5.2-preview.1",routeTemplate:"_apis/PermissionsReport/{id}"})}async download(e){return this.beginRequest({apiVersion:"5.2-preview.1",httpResponseType:"application/octet-stream",routeTemplate:"_apis/PermissionsReport/{id}/download",routeValues:{id:e}})}}t[e].PermissionsReportClientName="IPermissionsReportRestClient",t[e].getPermissionsReportClient=function(r,i){return r.getRestClient(t[e].PermissionsReportClientName,i)},r.RestClients.add(t[e].PermissionsReportClientName,{factory:s,options:{serviceInstanceType:"00025394-6065-48ca-87d9-7f5672854ef7"}})}("RestClientPermissionsReport"),function(e){t[e]={};class s extends i.RestClientBase{constructor(e){super(e)}async getGeoRegion(e){const t={ip:e};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/Profile/GeoRegion",queryParams:t})}async getRegions(){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/Profile/Regions"})}}t[e].ProfileClientName="ProfileRegion-AdminArea.IProfileRestClient",t[e].getProfileClient=function(r,i){return r.getRestClient(t[e].ProfileClientName,i)},r.RestClients.add(t[e].ProfileClientName,{factory:s,options:{resourceAreaId:"8ccfef3d-2b87-4e99-8ccb-66e343d2daa8",serviceInstanceType:"00000041-0000-8888-8000-000000000000"}})}("RestClientProfile"),function(e){t[e]={};class s extends i.RestClientBase{constructor(e){super(e)}async getProjectAdminString(e){return this.beginRequest({apiVersion:"5.1-preview.1",routeTemplate:"{project}/_apis/ProjectSettings/Project",routeValues:{project:e}})}}t[e].ProjectSettingsClientName="IProjectSettingsRestClient",t[e].getProjectSettingsClient=function(r,i){return r.getRestClient(t[e].ProjectSettingsClientName,i)},r.RestClients.add(t[e].ProjectSettingsClientName,{factory:s})}("RestClientProjectSettings"),function(e){h=t[e]={};class s extends i.RestClientBase{constructor(e){super(e)}async getProjectLimit(e){return this.beginRequest({apiVersion:"7.1-preview.1",routeTemplate:"{project}/_apis/ResourceUsage",routeValues:{project:e}})}async getLimits(){return this.beginRequest({apiVersion:"7.1-preview.1",routeTemplate:"_apis/ResourceUsage"})}}t[e].ResourceUsageClientName="IResourceUsageRestClient",t[e].getResourceUsageClient=function(r,i){return r.getRestClient(t[e].ResourceUsageClientName,i)},r.RestClients.add(t[e].ResourceUsageClientName,{factory:s,options:{resourceAreaId:"240a9b11-3dc7-4aa0-b3fe-2b7dc8a4e7ea"}})}("RestClientResourceUsage"),function(e){t[e]={};class n extends i.RestClientBase{constructor(e){super(e)}async fetchAdvancedCodeSearchResults(e,t){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"{project}/_apis/search/advancedCodeSearchResults",routeValues:{project:t},body:e})}async fetchBoardSearchResults(e,t){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"{project}/_apis/search/boardSearchResults",routeValues:{project:t},body:e})}async fetchScrollCodeSearchResults(e,t){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"{project}/_apis/search/codeSearchPaginatedResults",routeValues:{project:t},body:e})}async fetchCodeSearchResults(e,t){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"{project}/_apis/search/codeSearchResults",routeValues:{project:t},body:e})}async getCustomRepositoryStatus(e,t){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/search/status/customRepositories/{repository}",routeValues:{project:e,repository:t}})}async getCustomRepositoryBranchStatus(e,t,r){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/search/customRepositoryBranch/{repository}/{branch}",routeValues:{project:e,repository:t,branch:r}})}async fetchPackageSearchResults(e){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"_apis/search/packageSearchResults",body:e,returnRawResponse:!0}).then((async e=>{const t=await e.text().then(s.deserializeVssJsonObject),r=e.headers.get("ActivityId");return{content:t,activityId:r?r.split(","):[]}}))}async getRepositoryStatus(e,t){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/search/status/repositories/{repository}",routeValues:{project:e,repository:t}})}async fetchSettingSearchResults(e){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"_apis/search/settingSearchResults",body:e})}async getTfvcRepositoryStatus(e){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{project}/_apis/search/status/tfvc",routeValues:{project:e}})}async fetchWikiSearchResults(e,t){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"{project}/_apis/search/wikiSearchResults",routeValues:{project:t},body:e})}async fetchWorkItemInstantSearchResults(e,t){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"{project}/_apis/search/workItemInstantSearchResults",routeValues:{project:t},body:e})}async fetchWorkItemSearchResults(e,t){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"{project}/_apis/search/workItemSearchResults",routeValues:{project:t},body:e})}}t[e].SearchClientName="Setting_Search.ISearchRestClient",t[e].getSearchClient=function(r,i){return r.getRestClient(t[e].SearchClientName,i)},r.RestClients.add(t[e].SearchClientName,{factory:n,options:{serviceInstanceType:"00000010-0000-8888-8000-000000000000"}})}("RestClientSearch"),function(e){t[e]={};class s extends i.RestClientBase{constructor(e){super(e)}async removeAccessControlEntries(e,t,r){const i={token:t,descriptors:r};return this.beginRequest({apiVersion:"5.0-preview.1",method:"DELETE",routeTemplate:"_apis/AccessControlEntries/{securityNamespaceId}",routeValues:{securityNamespaceId:e},queryParams:i})}async setAccessControlEntries(e,t){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"_apis/AccessControlEntries/{securityNamespaceId}",routeValues:{securityNamespaceId:t},body:e})}async queryAccessControlLists(e,t,r,i,s){const n={token:t,descriptors:r,includeExtendedInfo:i,recurse:s};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/AccessControlLists/{securityNamespaceId}",routeValues:{securityNamespaceId:e},queryParams:n})}async removeAccessControlLists(e,t,r){const i={tokens:t,recurse:r};return this.beginRequest({apiVersion:"5.0-preview.1",method:"DELETE",routeTemplate:"_apis/AccessControlLists/{securityNamespaceId}",routeValues:{securityNamespaceId:e},queryParams:i})}async setAccessControlLists(e,t){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"_apis/AccessControlLists/{securityNamespaceId}",routeValues:{securityNamespaceId:t},body:e})}async hasPermissionsBatch(e){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"_apis/Security/PermissionEvaluationBatch",body:e})}async hasPermissions(e,t,r,i,s){const n={tokens:r,alwaysAllowAdministrators:i,delimiter:s};return this.beginRequest({apiVersion:"5.0-preview.2",routeTemplate:"_apis/Permissions/{securityNamespaceId}/{permissions}",routeValues:{securityNamespaceId:e,permissions:t},queryParams:n})}async removePermission(e,t,r,i){const s={descriptor:t,token:i};return this.beginRequest({apiVersion:"5.0-preview.2",method:"DELETE",routeTemplate:"_apis/Permissions/{securityNamespaceId}/{permissions}",routeValues:{securityNamespaceId:e,permissions:r},queryParams:s})}async querySecurityNamespaces(e,t){const r={localOnly:t};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/SecurityNamespaces/{securityNamespaceId}",routeValues:{securityNamespaceId:e},queryParams:r})}async setInheritFlag(e,t){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"_apis/SecurityNamespaces/{securityNamespaceId}",routeValues:{securityNamespaceId:t},body:e})}}t[e].SecurityClientName="Security-Admin.ISecurityRestClient",t[e].getSecurityClient=function(r,i){return r.getRestClient(t[e].SecurityClientName,i)},r.RestClients.add(t[e].SecurityClientName,{factory:s})}("RestClientSecurity"),function(e){t[e]={};class s extends i.RestClientBase{constructor(e){super(e)}async getPolicy(e){return this.beginRequest({apiVersion:"5.1-preview.1",routeTemplate:"_apis/TenantPolicy/Policies/{policyName}",routeValues:{policyName:e}})}async setPolicy(e,t){return this.beginRequest({apiVersion:"5.1-preview.1",method:"POST",routeTemplate:"_apis/TenantPolicy/Policies/{policyName}",routeValues:{policyName:t},body:e})}async getPolicyInfo(e){return this.beginRequest({apiVersion:"5.1-preview.1",routeTemplate:"_apis/TenantPolicy/PolicyInformation/{policyName}",routeValues:{policyName:e}})}}t[e].TenantPolicyClientName="ITenantPolicyRestClient",t[e].getTenantPolicyClient=function(r,i){return r.getRestClient(t[e].TenantPolicyClientName,i)},r.RestClients.add(t[e].TenantPolicyClientName,{factory:s,options:{serviceInstanceType:"951917ac-a960-4999-8464-e3f0aa25b381"}})}("RestClientTenantPolicy"),function(e){t[e]={};class s extends i.RestClientBase{constructor(e){super(e)}async exchangeAccessTokenKey(e,t){const r={isPublic:t};return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"_apis/Token/AccessTokens/{key}",queryParams:r,body:e})}async getAccessToken(e,t){const r={isPublic:t};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/Token/AccessTokens/{key}",routeValues:{key:e},queryParams:r})}async issueAppSessionToken(e,t){const r={clientId:e,userId:t};return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"_apis/Token/AppSessionTokens",queryParams:r})}async exchangeAppToken(e){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"_apis/Token/AppTokenPairs",body:e})}async createSessionToken(e,t,r,i){const s={tokenType:t,isPublic:r,isRequestedByTfsPatWebUI:i};return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"_apis/Token/SessionTokens/{authorizationId}",queryParams:s,body:e})}async getSessionToken(e,t){const r={isPublic:t};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/Token/SessionTokens/{authorizationId}",routeValues:{authorizationId:e},queryParams:r})}async getSessionTokens(e,t){const r={isPublic:e,includePublicData:t};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/Token/SessionTokens/{authorizationId}",queryParams:r})}async getSessionTokensPage(e,t,r,i,s,n,o,a,c){const u={displayFilterOption:e,createdByOption:t,sortByOption:r,isSortAscending:i,startRowNumber:s,pageSize:n,pageRequestTimeStamp:o,isPublic:a,includePublicData:c};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"_apis/Token/SessionTokens/{authorizationId}",queryParams:u})}async removePublicKey(e,t){const r={remove:t};return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"_apis/Token/SessionTokens/{authorizationId}",queryParams:r,body:e})}async revokeAllSessionTokensOfUser(){return this.beginRequest({apiVersion:"5.0-preview.1",method:"DELETE",routeTemplate:"_apis/Token/SessionTokens/{authorizationId}"})}async revokeSessionToken(e,t){const r={isPublic:t};return this.beginRequest({apiVersion:"5.0-preview.1",method:"DELETE",routeTemplate:"_apis/Token/SessionTokens/{authorizationId}",routeValues:{authorizationId:e},queryParams:r})}}t[e].TokenClientName="Token-Admin.ITokenRestClient",t[e].getTokenClient=function(r,i){return r.getRestClient(t[e].TokenClientName,i)},r.RestClients.add(t[e].TokenClientName,{factory:s,options:{serviceInstanceType:"951917ac-a960-4999-8464-e3f0aa25b381"}})}("RestClientToken"),function(e){t[e]={};class s extends i.RestClientBase{constructor(e){super(e)}async deleteAttribute(e,t){return this.beginRequest({apiVersion:"5.0-preview.2",method:"DELETE",routeTemplate:"{descriptor}/Attributes/{*attributeName}",routeValues:{descriptor:e,attributeName:t}})}async getAttribute(e,t){return this.beginRequest({apiVersion:"5.0-preview.2",routeTemplate:"{descriptor}/Attributes/{*attributeName}",routeValues:{descriptor:e,attributeName:t}})}async queryAttributes(e,t,r,i){const s={continuationToken:t,queryPattern:r,modifiedAfter:i};return this.beginRequest({apiVersion:"5.0-preview.2",routeTemplate:"{descriptor}/Attributes/{*attributeName}",routeValues:{descriptor:e},queryParams:s})}async setAttributes(e,t){return this.beginRequest({apiVersion:"5.0-preview.2",method:"PATCH",routeTemplate:"{descriptor}/Attributes/{*attributeName}",routeValues:{descriptor:t},body:e})}async deleteAvatar(e){return this.beginRequest({apiVersion:"5.0-preview.1",method:"DELETE",routeTemplate:"{descriptor}/Avatar",routeValues:{descriptor:e}})}async getAvatar(e,t,r){const i={size:t,format:r};return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{descriptor}/Avatar",routeValues:{descriptor:e},queryParams:i})}async setAvatar(e,t){return this.beginRequest({apiVersion:"5.0-preview.1",method:"PUT",routeTemplate:"{descriptor}/Avatar",routeValues:{descriptor:t},body:e})}async createAvatarPreview(e,t,r,i){const s={size:r,displayName:i};return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"{descriptor}/AvatarPreview",routeValues:{descriptor:t},queryParams:s,body:e})}async getDescriptor(e){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{descriptor}/Descriptor",routeValues:{descriptor:e}})}async disableUserProfileSync(e){return this.beginRequest({apiVersion:"5.0-preview.1",method:"PATCH",routeTemplate:"{descriptor}/DisableUserProfileSync",routeValues:{descriptor:e}})}async enableUserProfileSync(e){return this.beginRequest({apiVersion:"5.0-preview.1",method:"PATCH",routeTemplate:"{descriptor}/EnableUserProfileSync",routeValues:{descriptor:e}})}async confirmMail(e,t){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"{descriptor}/MailConfirmation",routeValues:{descriptor:t},body:e})}async getMostRecentlyAccessedHosts(e){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{descriptor}/MostRecentlyAccessedHosts",routeValues:{descriptor:e}})}async updateMostRecentlyAccessedHosts(e){return this.beginRequest({apiVersion:"5.0-preview.1",method:"POST",routeTemplate:"MostRecentlyAccessedHosts",body:e})}async getStorageKey(e){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"{descriptor}/StorageKey",routeValues:{descriptor:e}})}async getUserDefaults(){return this.beginRequest({apiVersion:"5.0-preview.1",routeTemplate:"UserDefaults"})}async createUser(e,t){const r={createLocal:t};return this.beginRequest({apiVersion:"5.0-preview.2",method:"POST",routeTemplate:"{descriptor}",queryParams:r,body:e})}async deleteUser(e){return this.beginRequest({apiVersion:"5.0-preview.2",method:"DELETE",routeTemplate:"{descriptor}",routeValues:{descriptor:e}})}async getUser(e,t){return this.beginRequest({apiVersion:"5.0-preview.2",routeTemplate:"{descriptor}",routeValues:{descriptor:e},customHeaders:{"X-VSS-FaultInUser":t}})}async updateUser(e,t){return this.beginRequest({apiVersion:"5.0-preview.2",method:"PATCH",routeTemplate:"{descriptor}",routeValues:{descriptor:t},body:e})}}t[e].UserClientName="User-AdminArea.IUserRestClient",t[e].getUserClient=function(r,i){return r.getRestClient(t[e].UserClientName,i)},r.RestClients.add(t[e].UserClientName,{factory:s,options:{serviceInstanceType:"00000038-0000-8888-8000-000000000000"}})}("RestClientUser"),function(e){let r;t[e]={},t[e].isIE=function(){if(void 0===r){const e=navigator.userAgent.toLowerCase(),t=/msie ([\d+.]+)/i.exec(e);r=!!t||-1!==e.indexOf("trident")}return r}}("UtilBrowserUtil"),function(e){t[e]={};t[e].CommonTestUtilities=class{static getContextMock(){return{pageContext:{getService:()=>({getIdentityImageUrl:()=>null})}}}static getCustomIdentityRefMock(e=!0){let t=Math.floor(50*Math.random())+1;return{id:this.generateGuid(),displayName:"Test Identity User"+t,preferredEmailAddress:"dummy"+t+"microsoft.com",imageUrl:"",isUser:e}}static generateGuid(){for(var e="",t=0;t<32;t++)e+=Math.floor(15*Math.random()).toString(15);return e}}}("UtilCommonTestUtilities"),function(e){t[e]={},t[e].CleanErrorMessage=function(e){if(!e)return"";if(e=e.toString(),(0,n.caseInsensitiveContains)(e,g.CustomErrorSearchString.CollectionAlreadyLinked))return m.OrganizationAlreadyLinked;if((0,n.caseInsensitiveContains)(e,g.CustomErrorSearchString.UnexpectedJsonToken)||(0,n.caseInsensitiveContains)(e,g.CustomErrorSearchString.JsonParseError))return m.ErrorOccurredPleaseTryAgain;if((0,n.caseInsensitiveContains)(e,g.CustomErrorSearchString.CollectionNotLinked))return m.OrganizationNotYetLinked;if((0,n.caseInsensitiveContains)(e,g.CustomErrorSearchString.IdentityMaterializationFailure)){var t=new RegExp(g.CustomErrorSearchString.IdentityMaterializationFailure,"ig");return e.replace(t,"")}if((0,n.caseInsensitiveContains)(e,g.CustomErrorSearchString.UserNeedsSignIn)){t=new RegExp(g.CustomErrorSearchString.UserNeedsSignIn,"ig");return e.replace(t,"")}if((0,n.caseInsensitiveContains)(e,g.CustomErrorSearchString.UserNotAuthorized))return m.UserNotAuthorized;if((0,n.caseInsensitiveContains)(e,g.CustomErrorSearchString.NetworkConnectionError)){t=new RegExp(g.CustomErrorSearchString.NetworkConnectionError,"ig");return e.replace(t,"")}if((0,n.caseInsensitiveContains)(e,g.CustomErrorSearchString.MicrosoftEmailAddress)){t=new RegExp(g.CustomErrorSearchString.MicrosoftEmailAddress,"ig");return e.replace(t,"")}if((0,n.caseInsensitiveContains)(e,g.CustomErrorSearchString.MoreThanOneCollection)){t=new RegExp(g.CustomErrorSearchString.MoreThanOneCollection,"ig");return e.replace(t,"")}return(0,n.caseInsensitiveContains)(e,g.CustomErrorSearchString.ExistingMembership)?m.AadMapExistingMembershipError:(0,n.caseInsensitiveContains)(e,g.CustomErrorSearchString.AcyclicMember)?m.AcyclicMember:e},t[e].ParseErrorFromAPI=function(e){return e.serverError?e.serverError.message?JSON.stringify(e.serverError.message):JSON.stringify(e.serverError):e.message?JSON.stringify(e.message):JSON.stringify(e)}}("UtilCustomErrorHelper"),function(e){t[e]={},t[e].validateEmail=function(e){return e=e.trim(),!!/^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+$/g.test(e)}}("UtilEmailValidator"),function(e){t[e]={},t[e].createMarkup=function(e){return{__html:e}}}("UtilHtmlString"),function(e){t[e]={};const r=["server","bin","App_code","App_Browsers","App_Data","App_GlobalResources","App_LocalResources","App_Themes","App_WebReferences","web.config","SignalR"],i=["prn","com1","com2","com3","com4","com5","com6","com7","com8","com9","com10","lpt1","lpt2","lpt3","lpt4","lpt5","lpt6","lpt7","lpt8","lpt9","nul","con","aux",".",".."],s=["@","~",";","{","}","'","+","=",",","<",">","|","/","\\","?",":","&","$","*",'"',"#","[","]","&","%"];t[e].validateProjectName=function(e){let t=0;if(null===e||0===e.length||e.length>64||"_"===e.substring(0,1)||"."===e.substring(0,1)||"."===e.charAt(e.length-1))return!1;for(t=0;t<s.length;t++)if(-1!==e.indexOf(s[t]))return!1;const o=[...i,...r];for(t=0;t<o.length;t++)if((0,n.equals)(e,o[t],!0))return!1;return!0},t[e].validateOrganizationName=function(e){return!(null===e||0===e.length||e.length>50||e.startsWith("-")||e.endsWith("-"))&&!!e.match(/^[0-9a-zA-Z-]+$/)}}("UtilNameValidator"),function(e){t[e]={},t[e].strongRegex=new RegExp("^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9])(?=.*?[#?!@$%^&*-]).{8,32}$"),t[e].cannotStartWithDigit=new RegExp("/^d/"),t[e].doesNotStartWithDigitAndOnlyAlphanumeric=/^[a-z][a-z0-9]*$/i}("UtilPasswordValidator"),function(e){t[e]={},t[e].getPermissionDisplayString=function(e){switch(e){case 0:default:return m.PV_NotSet;case 1:return m.PV_Allow;case 2:return m.PV_Deny;case 3:return m.PV_InheritedAllow;case 4:return m.PV_InheritedDeny;case 5:return m.PV_AllowedBySystem;case 6:return m.PV_DeniedBySystem}},t[e].PermissionsValueDisplayNames=[m.PV_NotSet,m.PV_Allow,m.PV_Deny],t[e].generateRowId=function(e){return e.namespaceId+e.bit},t[e].generateRowIdDirect=function(e,t){return e+t},t[e].getPermissionId=function(e){switch(e){case m.PV_NotSet:return 0;case m.PV_Allow:return 1;case m.PV_Deny:return 2;case m.PV_InheritedAllow:return 3;case m.PV_InheritedDeny:return 4;case m.PV_AllowedBySystem:return 5;case m.PV_DeniedBySystem:return 6;default:return 0}}}("UtilPermissionsHelper"),function(e){t[e]={};t[e].sendToast=function(e,t){const r=t.getService("IGlobalMessagesService");r&&r.addToast({message:e,duration:5e3})}}("UtilSendToastUtility"),function(e){T=t[e]={};t[e].TelemetrySanitizer=class{constructor(){this.CleanErrorMessage=e=>e?(e=e.toString(),(0,n.caseInsensitiveContains)(e,y.ErrorMessageSearchString.AccessDenied)?y.ErrorMessageReturnString.AccessDenied:(0,n.caseInsensitiveContains)(e,y.ErrorMessageSearchString.UserNotAuthorized)?y.ErrorMessageReturnString.UserNotAuthorized:(0,n.caseInsensitiveContains)(e,y.ErrorMessageSearchString.UserNeedsSignIn)?y.ErrorMessageReturnString.UserNeedsSignIn:(0,n.caseInsensitiveContains)(e,y.ErrorMessageSearchString.UserCouldNotBeAdded)?y.ErrorMessageReturnString.UserCouldNotBeAdded:(0,n.caseInsensitiveContains)(e,y.ErrorMessageSearchString.ActiveMemberNotAllowed)?y.ErrorMessageReturnString.ActiveMemberNotAllowed:(0,n.caseInsensitiveContains)(e,y.ErrorMessageSearchString.IdentityMaterializationFailure)?y.ErrorMessageReturnString.IdentityMaterializationFailure:(0,n.caseInsensitiveContains)(e,y.ErrorMessageSearchString.AccountInsufficientPermission)?y.ErrorMessageReturnString.AccountInsufficientPermission:(0,n.caseInsensitiveContains)(e,y.ErrorMessageSearchString.UpnPresent)?y.ErrorMessageReturnString.UpnPresent:e):""}}}("UtilTelemetryTelemetrySanitizer"),function(e){t[e]={};class r{constructor(e){this.sendTelemetry=(e,t,r,i)=>{this.sendComplexTelemetry(e,t,{Action:r,ErrorMessage:i?this._telemetrySanitizer.CleanErrorMessage(i):""})},this.sendComplexTelemetry=(e,t,r)=>{const i=this.context.getService("IVssTelemetryService");let s=r[y.TelemetryProperties.ErrorMessage];s&&(r[y.TelemetryProperties.ErrorMessage]=this._telemetrySanitizer.CleanErrorMessage(s)),i.publishEvent(e,t,r)},this.sendDataProviderTelemetry=(e,t,r,i)=>{this.sendComplexTelemetry(y.Area.Admin,e,{DataProvider:t,Result:r,ErrorMessage:this._telemetrySanitizer.CleanErrorMessage(i)})},this.startActionCapture=(e,t,r,s)=>(s||(s={}),s[y.TelemetryProperties.Action]=r,this.sendComplexTelemetry(y.Area.Admin,e,s),new i(this.context,e,t||e,r)),this.context=e,this._telemetrySanitizer=new T.TelemetrySanitizer}}t[e].AdminTelemetry=r;class i{constructor(e,t,s,n){this.captureAttemptStart=()=>{this.captureTelemetry({})},this.captureError=e=>{var t={};t[y.TelemetryProperties.Action]=this._action,t[y.TelemetryProperties.SubFeature]=this._subFeature,t[y.TelemetryProperties.ErrorMessage]=e,t[y.TelemetryProperties.PageUrl]=window.location.pathname.toLowerCase(),this._adminTelemetry.sendComplexTelemetry(y.Area.Admin,this._feature,t)},this.captureTelemetry=e=>{e[y.TelemetryProperties.Action]=this._action,e[y.TelemetryProperties.SubFeature]=this._subFeature,e[y.TelemetryProperties.PageUrl]=window.location.pathname.toLowerCase(),this._adminTelemetry.sendComplexTelemetry(y.Area.Admin,this._feature,e)},this.captureDataProviderCall=(e,t,r)=>{this._adminTelemetry.sendDataProviderTelemetry(this._feature,e,t,r)},this.getTelemetryLoggerForNewAction=e=>new i(this._pageContext,this._feature,this._subFeature,e),this._pageContext=e,this._adminTelemetry=new r(e),this._feature=t,this._subFeature=s,this._action=n}}t[e].AdminFeatureTelemetryLogger=i}("UtilTelemetryAdminTelemetry"),function(e){t[e]={},t[e].convertGraphMemberToIIdentity=function(e,t,r=!1){return t?{localId:t.originId,originId:t.originId,displayName:t.displayName,image:(0,o.getIdentityImageUrl)(e,{descriptor:t.descriptor})+(r?`?${(new Date).getTime()}`:""),subjectDescriptor:t.descriptor,entityType:t.subjectKind,mail:t.mailAddress}:{}},t[e].convertIIdentityToGraphMember=function(e){return e?{originId:e.localId||e.originId,displayName:0==(0,n.localeIgnoreCaseComparer)(e.entityType,d.group)&&e.samAccountName?e.samAccountName:e.displayName,descriptor:e.subjectDescriptor,subjectKind:e.entityType,mailAddress:e.mail,principalName:e.displayName}:{}},t[e].convertGraphGroupToIIdentity=function(e,t,r=!1){return t?{localId:t.originId,originId:t.originId,displayName:t.principalName,image:(0,o.getIdentityImageUrl)(e,{descriptor:t.descriptor})+(r?`?${(new Date).getTime()}`:""),subjectDescriptor:t.descriptor,entityType:t.subjectKind,mail:"",originDirectory:""}:{}},t[e].convertIdentityRefToGraphMember=function(e){if(!e)return{};const{displayName:t}=e;return Object.assign(Object.assign({},e),{subjectKind:e.isContainer?d.IEntityType.Group:d.IEntityType.User,principalName:t,displayName:t.substring(t.indexOf("\\")+1),mailAddress:e.isContainer?void 0:e.uniqueName})}}("UtilTypeConverters"),function(e){t[e]={};class r extends c.VssComponent{constructor(e,t){super(e,t),this.state={limits:{},projectId:e.projectId},this.getTeamProjectCollectionLimits=this.getTeamProjectCollectionLimits.bind(this),this.getTeamCollectionLimits=this.getTeamCollectionLimits.bind(this)}async componentDidMount(){const e={ProjectOverview:this.getTeamProjectCollectionLimits,OrganizationOverview:this.getTeamCollectionLimits}[this.props.source];if(e)try{const t=await e(this.context.pageContext);this.setState({limits:t})}catch(e){console.error("exception occured"+e),this.setState({limits:{}})}}getProgressBarColor(e,t){const r=e/t*100;return r>=90?"red-bar":r>=75?"yellow-bar":"green-bar"}render(){const{limits:e}=this.state,t=Object.entries(this.state.limits).map((([e,t])=>({type:e,usage:void 0!==t.count&&void 0!==t.limit?`${t.count},${t.limit}`:"0,0"})));return a.createElement("div",null,a.createElement("div",{className:"title-m service-title"},this.props.resourceUsageName),a.createElement(u.Table,{ariaLabel:"Basic Table",className:"usage-limit-table",columns:[{columnLayout:2,id:"type",name:"Type",readonly:!0,renderCell:u.renderSimpleCell,width:240,headerClassName:"usage-limit usage-limit-table-header-cell",className:"usage-limit body-m usage-limit-body usage-limit-table-cell-content"},{id:"usage",name:"Usage",readonly:!0,width:380,headerClassName:"usage-limit-table-header-cell",renderCell:(e,t,r,i)=>{const[s,n]=i.usage.split(",").map(Number),o=this.getProgressBarColor(s,n),c=s/n*100;return a.createElement("div",{className:"flex-row flex-center data-container usage-limit-data-container"},a.createElement("div",{className:"progress-bar-container usage-limit-progress-bar-container data-container usage-limit-data-container"},a.createElement("div",{className:`usage-limit-progress-bar-filled ${o}`,style:{flex:`${c}`}}),a.createElement("div",{className:"usage-limit-progress-bar-remaining",style:{flex:""+(100-c)}})),a.createElement("span",{className:"usage-limit-text"},`${s}/${n}`),"yellow-bar"===o&&a.createElement(l.Icon,{iconName:"Warning",className:"usage-limit-Icon--Warning"}),"red-bar"===o&&a.createElement(l.Icon,{iconName:"Error",className:"usage-limit-Icon--Error"}))}}],itemProvider:new p.ArrayItemProvider(t)}))}async getTeamProjectCollectionLimits(e){const t=(0,h.getResourceUsageClient)(e);return await t.getProjectLimit(this.props.projectId)}async getTeamCollectionLimits(e){const t=(0,h.getResourceUsageClient)(e);return await t.getLimits()}}t[e].ResourceUsageComponent=r}("ComponentsResourceUsage")}),["Resources","Constants/Constants","Constants/CustomErrorConstants","Constants/DataProviderConstants","Constants/Generated/Constants","Constants/TelemetryConstants","Contracts/CustomIdentityRef","Contracts/IOrganizationIdentity","RestClient/EnterpriseCatalog","RestClient/Graph","RestClient/HostAcquisition","RestClient/Identities","RestClient/Invitation","RestClient/MarketingPreferences","RestClient/NewDomainUrlMigration","RestClient/NewDomainUrlOrchestration","RestClient/Operations","RestClient/Organization","RestClient/OrganizationPolicy","RestClient/OrganizationSettings","RestClient/PermissionLevel","RestClient/PermissionsReport","RestClient/Profile","RestClient/ProjectSettings","RestClient/ResourceUsage","RestClient/Search","RestClient/Security","RestClient/TenantPolicy","RestClient/Token","RestClient/User","Util/BrowserUtil","Util/CommonTestUtilities","Util/CustomErrorHelper","Util/EmailValidator","Util/HtmlString","Util/NameValidator","Util/PasswordValidator","Util/PermissionsHelper","Util/SendToastUtility","Util/Telemetry/TelemetrySanitizer","Util/Telemetry/AdminTelemetry","Util/TypeConverters","Components/ResourceUsage"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-admin-web.admin-common-content"}}));