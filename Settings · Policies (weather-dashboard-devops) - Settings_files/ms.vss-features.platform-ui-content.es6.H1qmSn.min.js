"use strict";define("VSS/Features/PlatformUI",["require","exports","react","VSS/Platform/Location","VSS/Platform/Theming","VSS/Platform/Util/Url","VSSUI/Icon","VSSUI/Image","VSSUI/Util","VSSUI/Button","VSSUI/ButtonGroup","VSS/Platform/Layout","VSS/Platform/Context","VSS/Core/Observable","VSS/Platform/Trace","VSSUI/Observer","VSSUI/Pill","VSSUI/PillGroup","VSSUI/TooltipEx","VSS/Platform/FPS","VSSUI/Link","VSS/Platform/Feature"],(function(e,t,n,i,o,s,r,a,c,u,l,d,m,p,b,g,f,h,C,v,I,y){var S,P,x,D,w,O,E,M,T,k,B,V,j,L;S=t[L="Resources"]={},t[L].cancel="Cancel",t[L].leave="Leave",t[L].leavePageDialogTitle="Are you sure you want to leave the page?",t[L].loading="Loading",t[L].ok="OK",t[L].stay="Stay",t[L].unsavedChangesDefaultMessage="You have unsaved changes.",function(e){function u(e,t,i,r){let u;if(i){let l,d;if("object"==typeof i?l=i[(0,o.getCurrentTheme)(e).isDark?"dark":"light"]:(d="non-themed",l=i),l&&!l.startsWith("css://")){if(!l.match(/^https?:\/\//)&&t){const n=e.getService("IVssContributionService").getContributionProvider(t);n&&(l=(0,s.combineUrlPaths)(n.baseUri,l))}u={render:e=>n.createElement(a.Image,{alt:r,className:(0,c.css)(e,d,"contributed-icon-image"),src:l})}}}return u}P=t[e]={},t[e].contributedIconToIconProps=u,t[e].ContributedIcon=function(e){const t=(0,c.css)(e.className,"contributed-icon");if(e.iconProps)return n.createElement(r.Icon,Object.assign({},e.iconProps,{className:(0,c.css)(t,e.iconProps.className)}));if(e.iconAsset){const o=(0,i.getAssetLocation)(e.pageContext,e.iconAsset);if(o)return n.createElement(a.Image,{alt:e.alt,className:(0,c.css)(t,"contributed-icon-image"),src:o})}if(e.icon){const i=u(e.pageContext,e.contributionId,e.icon,e.alt);if(i)return n.createElement(r.Icon,Object.assign({className:t},i,{size:e.iconSize}))}return e.iconName?n.createElement(r.Icon,{className:t,iconName:e.iconName,size:e.iconSize}):null}}("ComponentsContributedIconContributedIcon"),function(e){function i(e,t){const n={disabled:t.disabled,href:t.href,primary:t.primary,target:t.target,text:t.text};return t.tooltip&&(n.ariaLabel=t.tooltip,n.tooltipProps={text:t.tooltip}),t.href&&t.target&&(n.rel="noopener noreferrer"),t.icon&&(n.iconProps=(0,P.contributedIconToIconProps)(e,t.contributionId,t.icon)),t.command&&(n.onClick=()=>{const n=t.commandArguments||[];if("string"==typeof t.command){e.getService("IVssContributionService").executeCommand(t.command,...n)}else if(t.contributionId){e.getService("IVssContributionService").executeCommandEx(t.contributionId,t.command,...n)}}),n}x=t[e]={},t[e].contributedButtonToButtonProps=i,t[e].ContributedButtonGroup=function(e){const{pageContext:t,className:o,buttons:s}=e;return n.createElement(l.ButtonGroup,{className:o},s.map((e=>n.createElement(u.Button,Object.assign({},i(t,e))))))}}("ComponentsContributedButtonContributedButton"),function(e){D=t[e]={},t[e].ContributedContent=function(e){const{className:t,componentProperties:i,contribution:o,contributionId:s,dependencies:r}=e,a=(0,d.useComponentContext)(),u=Object.assign(Object.assign(Object.assign({},i),o.componentProperties),{className:(0,c.css)(t,i&&i.className,o.componentProperties&&o.componentProperties.className)}),l=[...r||[],...o.dependencies||[]];if(o.uri)return n.createElement(d.WrappedComponent,{dependencies:l.concat(["ms.vss-web.ext-content"]),onDependenciesResolved:e.onDependenciesResolved,wrappedType:"ExternalContent",wrappedProps:Object.assign(Object.assign({initialHandshakeData:i&&i.context},u),{contributionId:s})});if(o.componentType){if(a.pageContext.getService("IVssContributionService").isContributionTrusted(s))return n.createElement(d.WrappedComponent,{dependencies:l,onDependenciesResolved:e.onDependenciesResolved,wrappedType:o.componentType,wrappedProps:u})}return null}}("ComponentsContributedContentContributedContent"),function(e){w=t[e]={},t[e].getContributedItems=function(e,t,n,i){const o=[],s=e.getService("IVssContributionService"),r=[],a={},c=s.getContributionChildren(t,i);if(c)for(const e of c)a[e]=!0,r.push(e);if(n){const e=s.getContributionsByType(i);if(e)for(const i in e)if(!a[i]){const o=e[i];o&&o[n]===t&&r.push(i)}}for(const e of r){const t=s.getContribution(e);t&&o.push({id:e,contribution:t})}return o},t[e].wrapExternalObservable=function(e){if(e){const t=e,n=t.subscribe;"function"==typeof n&&(t.subscribe=(i,o)=>{const s=(t,n)=>{const o=e;"set"===n&&void 0!==o.value&&(o.value=t),i(t,n)};return(0,m.setRemoteSerializationSettings)(s,{proxyFunctions:!0}),n.call(t,s,o)})}return e}}("ContributedItemUtil"),function(e){function i(e,t,n,i,o,s){const r=n.getPills(i,s),a=r,c=r;a&&"function"==typeof a.then?a.then((e=>{e&&t.push((0,w.wrapExternalObservable)(e),(e=>Object.assign(Object.assign({},e),{contributionId:o})))}),(t=>{const n=`Failed to load pills for ${i}: ${JSON.stringify(t||"")}`;(0,b.traceWarning)(e,"extensions","ContributedPillGroup",n,{pillGroupId:i}),console.warn(n)})):c&&t.push(c,(e=>Object.assign(Object.assign({},e),{contributionId:o})))}function o(e,t,n,o){const s=e.getService("IVssContributionService"),r=(0,w.getContributedItems)(e,n,"pillGroupId","ms.vss-web.pill-provider");for(const a of r){const r=s.getServiceSync(a.id);r?i(e,t,r,n,a.id,o):s.getService(a.id).then((s=>{s&&i(e,t,s,n,a.id,o)}))}}O=t[e]={},t[e].getPills=function(e,t,n){const i=new p.ObservableCollection;return o(e,i,t,n),i},t[e].addPills=o,t[e].ContributedPillGroup=function(e){const{className:t,overflow:i,pageContext:o,pills:s,size:r}=e;return n.createElement(g.Observer,{pills:s},(e=>e.pills.length?n.createElement(h.PillGroup,{className:t,overflow:i},e.pills.map(((e,t)=>n.createElement(f.Pill,Object.assign({},function(e,t){return{children:n.createElement(C.Tooltip,{text:""+(t.tooltip||t.text),overflowOnly:!t.tooltip},n.createElement("span",null,""+t.text)),color:t.color,iconProps:(0,P.contributedIconToIconProps)(e,t.contributionId,t.icon),onClick:t.onClick?()=>t.onClick():void 0,onRemoveClick:t.onClick?()=>t.onRemoveClick():void 0,variant:t.color?2:0}}(o,e),{key:t,size:r}))))):null))}}("ComponentsContributedPillGroupContributedPillGroup"),function(e){E=t[e]={};class i extends d.VssComponent{constructor(){super(...arguments),this.onClick=e=>{if(this.props.onClick&&this.props.onClick(e),!e.isDefaultPrevented())if(this.props.href&&!1!==this.props.supportsFPS)(0,v.onClickFPS)(this.context.pageContext,this.props.href,!0,e,{telemetrySource:this.props.telemetrySource,telemetryProperties:this.props.telemetryProperties,navigationId:this.props.navigationId});else if(this.props.telemetrySource){this.context.pageContext.getService("IVssTelemetryService").publishEvent("WebPlatform","Link",Object.assign(Object.assign({},this.props.telemetryProperties||{}),{source:this.props.telemetrySource}))}}}render(){const e=Object.assign(Object.assign({},this.props),{onClick:this.onClick});return n.createElement(I.Link,Object.assign({},e))}}t[e].FPSLink=i}("ComponentsFPSLinkFPSLink"),function(e){M=t[e]={};let i=1;t[e].MessageDialog=e=>{const t="message-dialog-dialog-content-"+i++,o={ariaDescribedBy:t,lightDismiss:!1!==e.lightDismiss,onDismiss:()=>{e.onClose(!1)},role:"alertdialog",titleProps:{text:e.title}},s={maxWidth:"217px"},r=[];if(!1!==e.showCancel){const t=Object.assign({id:`message-dialog-cancel-button-${i}`,text:S.cancel,style:s},e.cancelButtonProps);t.onClick=()=>{e.onClose(!1)},r.push(t),o.defaultActiveElement="#"+t.id}const a=Object.assign({id:`message-dialog-ok-button-${i}`,text:S.ok,style:s,primary:!0},e.okButtonProps);return a.onClick=()=>{e.onClose(!0)},r.push(a),o.defaultActiveElement||(o.defaultActiveElement="#"+a.id),o.footerButtonProps=r,o.defaultActiveElement=`#${(0,c.getSafeId)(r[0].id)}`,n.createElement(d.WrappedComponent,{dependencies:["ms.vss-features.ui-layer-content"],wrappedType:"dialog",wrappedProps:o},n.createElement("div",{id:(0,c.getSafeId)(t)},e.message))},t[e].showMessageDialog=function(i,o){i.getService("IVssLayoutManager").renderCallout((i=>n.createElement(t[e].MessageDialog,Object.assign({},o,{onClose:e=>{o.onClose(e),i()}}))))}}("ComponentsMessageDialogMessageDialog"),function(e){T=t[e]={},function(e){e.DisableDynamicTabsProcessing="WebAccess.Agile.DisableDynamicTabsProcessing"}(t[e].Constants||(t[e].Constants={}))}("Constants"),function(e){t[e]={},t[e].getBreadcrumbItems=function(e,t){const n=new p.ObservableCollection,i=e.getService("IVssContributionService"),o=i.getSharedData("_breadcrumbItems");if(o){const e=o[t];e&&n.push(e)}const s=(0,w.getContributedItems)(e,t,"breadcrumbId","ms.vss-web.breadcrumb-item");n.push(s,(e=>({hidden:e.contribution.hidden,href:e.contribution.href,key:e.contribution.key||e.id,text:e.contribution.text,rank:e.contribution.rank,priority:e.contribution.priority})));const r=(0,w.getContributedItems)(e,t,"breadcrumbId","ms.vss-web.breadcrumb-provider");for(const o of r){const s=i.getServiceSync(o.id);if(s){const e=s.getBreadcrumbItems(t);e&&n.push(e)}else i.getService(o.id).then((i=>{if(i)if(i.getBreadcrumbItems){const o=i.getBreadcrumbItems(t),s=o;s&&"function"==typeof s.then?s.then((e=>{e&&n.push((0,w.wrapExternalObservable)(e))}),(n=>{const i=`Failed to load tabs for ${t}: ${JSON.stringify(n||"")}`;(0,b.traceWarning)(e,"extensions","ContributedBreadcrumb",i,{breadcrumbId:t}),console.warn(i)})):o&&n.push(o)}else n.push((0,w.wrapExternalObservable)(i))}))}return n}}("ContributedBreadcrumb"),function(e){t[e]={},Object.defineProperty(t[e],"ContributedButtonGroup",{enumerable:!0,get:function(){return x.ContributedButtonGroup}}),Object.defineProperty(t[e],"contributedButtonToButtonProps",{enumerable:!0,get:function(){return x.contributedButtonToButtonProps}})}("ContributedButton"),function(e){k=t[e]={},Object.defineProperty(t[e],"ContributedContent",{enumerable:!0,get:function(){return D.ContributedContent}})}("ContributedContent"),function(e){B=t[e]={},Object.defineProperty(t[e],"ContributedIcon",{enumerable:!0,get:function(){return P.ContributedIcon}}),Object.defineProperty(t[e],"contributedIconToIconProps",{enumerable:!0,get:function(){return P.contributedIconToIconProps}})}("ContributedIcon"),function(e){V=t[e]={};const i="WebAccess.WorkItemTracking.ContributionMenuItemsDuplicationFixEnabled";function o(e,t){return n=>{const i=`Failed to load menu items for ${t}: ${JSON.stringify(n||"")}`;(0,b.traceWarning)(e,"extensions","ContributedMenu",i,{menuId:t}),console.warn(i)}}function s(e,t,n,i,o){let s;if(t.contribution.uri||!i){if(s=new g(e,t.id,t.contribution,n),o&&o.processExternalMenuItem&&(s=o.processExternalMenuItem(s,t.contribution)),s&&!s.text&&!s.iconProps&&!s.subMenuProps)return void console.warn("Ignored invalid external menu item: "+t.id)}else s=new l(e,t.contribution,n);return s}function r(e,t,n,i,o,s){const r=new p.ObservableCollection;return a(e,r,t,n,i,o,s),r}async function a(e,t,n,i,o,r,a){const u=e.getService("IVssContributionService"),l=u.getSharedData("_menuItems");if(l){const r=l[n];r&&r.length>0&&t.push(r,(t=>s(e,{id:t.id,contribution:t},i,!0,o)))}if(t.push((0,w.getContributedItems)(e,n,"menuId","ms.vss-web.menu-item"),(t=>s(e,t,i,u.isContributionTrusted(t.id),o))),a){const s=new Array;s.push(...(0,w.getContributedItems)(e,n,"menuId","ms.vss-web.action")),await c(s,e,t,n,i,o,r,!0)}else t.push((0,w.getContributedItems)(e,n,"menuId","ms.vss-web.action"),(t=>s(e,t,i,u.isContributionTrusted(t.id),o)));return c([...(0,w.getContributedItems)(e,n,"menuId","ms.vss-web.menu-provider"),...(0,w.getContributedItems)(e,n,"menuId","ms.vss-web.action-provider")],e,t,n,i,o,r)}async function c(e,t,n,r,a,c,l,d){var m,b;const f=t.getService("IVssContributionService");for(const h of e){const e=f.getServiceSync(h.id,!0);if(e)if(e.getMenuItems){const t=e.getMenuItems(r,a);t&&n.push(t)}else d&&n.push([h],(e=>s(t,e,a,f.isContributionTrusted(e.id),c)));else{const e=h.contribution;if(e.uri){const u={serviceName:e.registeredObjectId||h.id,uri:e.uri};if((0,y.isFeatureFlagEnabled)(t,i,!1)){let i;try{i=await f.getServiceEx(h.id,u,!0)}catch(e){o(t,h.id)(e)}if(i){let u;if(c&&c.getExternalMenuItems?u=c.getExternalMenuItems(i,r,a):i.getMenuItems?u=!l||i._sdkVersion>=3?i.getMenuItems(r,a):i.getMenuItems(a):d&&n.push([h],(e=>s(t,e,a,f.isContributionTrusted(e.id),c))),u){let i=null;try{i=await u}catch(e){o(t,h.id)(e)}n.push(null!=i?i:[],(n=>{const i=new g(t,h.id,Object.assign({uri:e.uri},n),a);return c&&c.processExternalMenuItem?c.processExternalMenuItem(i,n):i}))}}}else f.getServiceEx(h.id,u,!0).then((i=>{if(i){let u;c&&c.getExternalMenuItems?u=c.getExternalMenuItems(i,r,a):i.getMenuItems?u=!l||i._sdkVersion>=3?i.getMenuItems(r,a):i.getMenuItems(a):d&&n.push([h],(e=>s(t,e,a,f.isContributionTrusted(e.id),c))),u&&u.then((i=>{n.push(null!=i?i:[],(n=>{const i=new g(t,h.id,Object.assign({uri:e.uri},n),a);return c&&c.processExternalMenuItem?c.processExternalMenuItem(i,n):i}))}),o(t,h.id))}}),o(t,h.id))}else if(u(f,h)){const e=t.getService("ILegacyPlatformService"),i=await e.requireModules(["VSS/SDK/Shim",...h.contribution.content.require]);if("function"==typeof(null===(b=null===(m=i[0])||void 0===m?void 0:m.VSS)||void 0===b?void 0:b.getRegisteredObject)){const e=i[0].VSS.getRegisteredObject(h.id);if("function"==typeof(null==e?void 0:e.getMenuItems)){const i=new p.ObservableArray([]),o=e=>{const n=new g(t,h.id,e,a);return c&&c.processExternalMenuItem?c.processExternalMenuItem(n,e):n},s=e=>Array.isArray(e)?e.map(o).filter((e=>!!e)):[],r=Object.assign(Object.assign({},a),{updateMenuItems:e=>{i.value=s(e)}}),u=await Promise.resolve(e.getMenuItems(r));i.value=s(u),n.push(i)}else d&&n.push([h],(e=>s(t,e,a,f.isContributionTrusted(e.id),c)))}}else f.getService(h.id).then((e=>{if(e&&e.getMenuItems){const t=e.getMenuItems(r,a);t&&n.push(t)}else d&&n.push([h],(e=>s(t,e,a,f.isContributionTrusted(e.id),c)))}),o(t,h.id))}}}function u(e,t){var n,i;if(!e.isContributionTrusted(t.id))return!1;const o=t.contribution;return!!(null===(i=null===(n=null==o?void 0:o.content)||void 0===n?void 0:n.require)||void 0===i?void 0:i[0])&&"string"==typeof o.content.require[0]}t[e].getMenuItems=r,t[e].getMenuItemsAsync=async function(e,t,n,i,o,s){const r=new p.ObservableCollection;return await a(e,r,t,n,i,o,s),r},t[e].addMenuItems=a;class l{constructor(e,t,i){this.onActivateCommand=e=>{const t=this.pageContext.getService("IVssContributionService"),n=this.contextualData?Object.assign(Object.assign({},this.data),this.contextualData):this.data;this.command?t.executeCommandEx(e.id,this.command,n):t.getService(e.id,!0).then((e=>{e&&e.execute&&e.execute(n)}))},this.renderMenuItemCustom=(e,t,i)=>n.createElement(d.WrappedComponent,{key:this.id,wrappedType:this.componentType,wrappedProps:{index:e,item:t,details:i}}),this.pageContext=e,this.className=t.className,this.checked=t.checked,this.data=t.data,this.contextualData=i,this.disabled=t.disabled,this.groupKey=t.groupKey,this.href=t.href,this.iconProps=t.iconProps,this.id=t.id||t.key||"",this.rank=t.rank,this.rel=t.rel,this.target=t.target,this.text=t.text||t.name,"-"===t.name?this.itemType=1:this.itemType=t.itemType,this.command=t.command,!this.command&&this.href||(this.onActivate=this.onActivateCommand);const o=t.subMenuId;o&&(this.subMenuProps={id:o,items:r(e,o,i)}),this.componentType=t.componentType,this.componentType&&(this.renderMenuItem=this.renderMenuItemCustom)}}let m=0;class g{constructor(e,t,n,i){if(this.onActivateExternalCommand=()=>{this.pageContext.getService("IVssContributionService").getServiceEx(this.contributionId,this.externalContributedService,!0).then((e=>{e&&e.execute&&e.execute(this.contextualData)}),o(this.pageContext,this.contributionId))},this.pageContext=e,this.contributionId=t,this.contextualData=i,this.disabled=n.disabled,this.groupKey=n.groupId,this.hidden=n.hidden,this.href=n.href,this.id=n.id||t||"ext-menu-"+ ++m,this.rank=n.rank,this.text=n.text||n.title,n.icon&&(this.iconProps=(0,B.contributedIconToIconProps)(e,t,n.icon)),!this.iconProps&&n.iconName&&(this.iconProps={iconName:n.iconName}),n.action?this.onActivate=()=>{n.action(this.contextualData)}:n.uri&&(this.externalContributedService={serviceName:n.registeredObjectId||t,uri:n.uri,configuration:this.contextualData},this.onActivate=this.onActivateExternalCommand),n.childItems){const i=new p.ObservableArray;"function"==typeof n.childItems.then?n.childItems.then((o=>{i.push(...o.map((i=>new g(e,t,Object.assign({uri:n.uri},i),this.contextualData))))}),o(e,this.contributionId)):i.push(...n.childItems.map((i=>new g(e,t,Object.assign({uri:n.uri},i),this.contextualData)))),this.subMenuProps={id:"ext-sub-menu-"+ ++m,items:i}}}}}("ContributedMenu"),function(e){t[e]={},Object.defineProperty(t[e],"addPills",{enumerable:!0,get:function(){return O.addPills}}),Object.defineProperty(t[e],"ContributedPillGroup",{enumerable:!0,get:function(){return O.ContributedPillGroup}}),Object.defineProperty(t[e],"getPills",{enumerable:!0,get:function(){return O.getPills}})}("ContributedPillGroup"),function(e){function i(e,t,i,o){if(t.preProcessTabContribution&&t.preProcessTabContribution(i),!i.render){const s=i,r=e=>n.createElement(d.WrappedComponent,{key:s.moduleContent,dependencies:["ms.vss-web.legacy-content","ms.vss-web.legacy-vss-ui-content"],wrappedType:"legacy",loadingComponent:t.loadingComponent,wrappedProps:{componentType:"vssLegacyContributionContentHost",modules:["VSSPreview/Providers/ContentHost"],dependentContributionIds:s.dependencies,wrappedProps:{className:"flex-grow",context:e.context,contribution:e.contribution}}});s.moduleContent?i.fpsRequired||t.fpsRequired?i.render=()=>n.createElement(d.WrappedComponent,{key:s.moduleContent,dependencies:["ms.vss-web.legacy-content","ms.vss-web.legacy-vss-ui-content"],wrappedType:"legacy",loadingComponent:t.loadingComponent,wrappedProps:{className:"flex-grow",componentType:"legacyHubShimComponent",dependentContributionIds:s.dependencies,modules:["VSSPreview/Flux/Components/ExternalHubShim"],contributionId:s.moduleContent}}):i.render=()=>n.createElement(r,{contribution:s.moduleContent,context:e}):s.content?i.render=()=>n.createElement(r,{contribution:s.id,context:t.contextualData}):i.render=()=>n.createElement(k.ContributedContent,{key:o,className:"flex-grow",contributionId:o,contribution:i,dependencies:i.dependencies,componentProperties:Object.assign({context:t.contextualData},t.props),loadingComponent:t.loadingComponent})}if(i.id||(i.id=o),i.routeId){const n=e.getService("IVssLocationService");i.url=n.routeUrl(i.routeId,Object.assign(Object.assign({},t.routeValues),i.routeValues))}else if(t.defaultRouteId){const n=e.getService("IVssLocationService"),s={};s[t.routeStateKey||"contributionId"]=i.id||o,i.url=n.routeUrl(t.defaultRouteId,s)}else if(t.routeStateKey){const n=e.getService("IVssHistoryService"),o={};o[t.routeStateKey]=i.id,i.url=n.generateUrl(o,1)}i.fpsRequired||t.fpsRequired?i.onBeforeTabChange=(t,n,i)=>!i||((0,v.FastPageSwitch)(e,i,!0),t&&t.preventDefault(),!1):i.url&&t.updateUrlOnPivotChange&&(i.onBeforeTabChange=(t,n,o)=>(e.getService("IVssHistoryService").pushState(void 0,i.url&&p.ObservableLike.getValue(i.url)),!0));const s=i;return s.commandBarMenuId&&!i.commandBarItems&&(i.commandBarItems=(0,V.getMenuItems)(e,s.commandBarMenuId,{tabId:i.id})),i}function o(e,t,n,o={}){const s=e.getService("IVssContributionService"),r=(0,w.getContributedItems)(e,n,"tabGroupId","ms.vss-web.tab");for(const n of r){const s=i(e,o,n.contribution,n.id);s.dynamic?(0,y.isFeatureFlagEnabled)(e,T.Constants.DisableDynamicTabsProcessing,!1)||c(n.id,s).then((e=>{e&&t.push([e])})):t.push([s])}const a=(0,w.getContributedItems)(e,n,"tabGroupId","ms.vss-web.tab-provider");for(const r of a){const a=s.getServiceSync(r.id,!0);if(a){const s=a.getTabs(n,o.contextualData);s&&t.push(s,(t=>i(e,o,t,t.id)))}else s.getService(r.id).then((s=>{if(s){const r=s.getTabs(n,o.contextualData),a=r;a&&"function"==typeof a.then?a.then((n=>{n&&t.push((0,w.wrapExternalObservable)(n),(t=>((0,w.wrapExternalObservable)(t.name),(0,w.wrapExternalObservable)(t.badgeCount),i(e,o,t,t.id))))}),(t=>{const i=`Failed to load tabs for ${n}: ${JSON.stringify(t||"")}`;(0,b.traceWarning)(e,"extensions","Contributedtab",i,{tabGroupId:n}),console.warn(i)})):r&&t.push(r,(t=>i(e,o,t,t.id)))}}))}async function c(t,n){const i=await async function(t){try{const n=e.getService("ILegacyPlatformService"),[i]=await n.requireModules(["VSS/Contributions/Controls"]),o=await i.getBackgroundHost(t);return await o.getRegisteredInstance(t,{})}catch(e){return}}(t);if(i){const e=await async function(e,t,n={}){var i,o,s;if(!e)return;const r=n.contextualData,a="function"==typeof e.isInvisible?await e.isInvisible(r):null!==(i=e.isInvisible)&&void 0!==i&&i;if(a)return{isInvisible:a};const[c,u,l]=await Promise.all(["function"==typeof e.name?e.name(r):null!==(o=e.name)&&void 0!==o?o:t.name,"function"==typeof e.title?e.title(r):e.title,"function"==typeof e.groupKey?e.groupKey(r):e.groupKey]);return{isDisabled:await(null===(s=e.isDisabled)||void 0===s?void 0:s.call(e,r)),isInvisible:a,name:c,title:u,groupKey:l}}(i,n,o);if(e&&!e.isInvisible)return(null==e?void 0:e.name)&&(n.name=e.name),n}}}t[e]={},t[e].processTabContribution=i,t[e].getTabs=function(e,t,n={}){const i=new p.ObservableCollection;return o(e,i,t,n),i},t[e].addTabs=o}("ContributedTab"),function(e){t[e]={},Object.defineProperty(t[e],"FPSLink",{enumerable:!0,get:function(){return E.FPSLink}})}("FPSLink"),function(e){j=t[e]={},Object.defineProperty(t[e],"MessageDialog",{enumerable:!0,get:function(){return M.MessageDialog}}),Object.defineProperty(t[e],"showMessageDialog",{enumerable:!0,get:function(){return M.showMessageDialog}})}("MessageDialog"),function(e){t.UnsavedChangesService={};class n extends m.VssService{constructor(){super(...arguments),this.documents=[],this.onBeforeUnload=e=>{const t=this.getDirtyDocumentMessage();if(t)return e.returnValue=t,e.preventDefault(),t},this.onFpsStarting=e=>{const t=this.getDirtyDocumentMessage(),n=this.getDirtyDocumentTitle(),i=this.getDirtyDocumentOnLeaveBtn(),o=this.getDirtyDocumentOnStayBtn();!(t&&n&&i&&o)||e.detail.data&&e.detail.data.userConfirmed||(e.preventDefault(),e.detail.cancellationReason="dirtyState",this.showMessage(n,t,i,o,(()=>{(0,v.FastPageSwitch)(e.detail.pageContext,e.detail.href,e.detail.recordHistoryEntry,Object.assign(Object.assign({},e.detail.data),{userConfirmed:!0}))})))},this.getDirtyDocumentMessage=()=>{for(const e of this.documents)if(!e.isDirty||e.isDirty())return e.getDirtyMessage&&e.getDirtyMessage()||S.unsavedChangesDefaultMessage},this.getDirtyDocumentTitle=()=>{for(const e of this.documents)if(!e.isDirty||e.isDirty())return e.getDirtyTitle&&e.getDirtyTitle()||S.leavePageDialogTitle},this.getDirtyDocumentOnStayBtn=()=>{for(const e of this.documents)if(!e.isDirty||e.isDirty())return e.getDirtyOnStayBtn&&e.getDirtyOnStayBtn()||S.stay},this.getDirtyDocumentOnLeaveBtn=()=>{for(const e of this.documents)if(!e.isDirty||e.isDirty())return e.getDirtyOnLeaveBtn&&e.getDirtyOnLeaveBtn()||S.leave}}_serviceStart(e){super._serviceStart(e),document.body.addEventListener("fpsStarting",this.onFpsStarting),window.addEventListener("beforeunload",this.onBeforeUnload)}_serviceEnd(e){super._serviceEnd(e),document.body.removeEventListener("fpsStarting",this.onFpsStarting),window.removeEventListener("beforeunload",this.onBeforeUnload)}register(e){this.documents.push(e)}registerFirst(e){this.documents.unshift(e)}unregister(e){this.documents=this.documents.filter((t=>t!==e))}triggerNavigateAway(e,t){const n=this.getDirtyDocumentMessage(),i=this.getDirtyDocumentTitle(),o=this.getDirtyDocumentOnLeaveBtn(),s=this.getDirtyDocumentOnStayBtn();n&&i&&o&&s?this.showMessage(i,n,o,s,e,t):e()}showMessage(e,t,n,i,o,s){(0,j.showMessageDialog)(this.pageContext,{cancelButtonProps:{text:i},lightDismiss:!1,message:t,onClose:e=>{e?o():s&&s()},okButtonProps:{text:n},title:e})}}m.Services.add("IUnsavedChangesService",{serviceFactory:n})}()}),["Resources","Components/ContributedIcon/ContributedIcon","Components/ContributedButton/ContributedButton","Components/ContributedContent/ContributedContent","ContributedItemUtil","Components/ContributedPillGroup/ContributedPillGroup","Components/FPSLink/FPSLink","Components/MessageDialog/MessageDialog","Constants","ContributedBreadcrumb","ContributedButton","ContributedContent","ContributedIcon","ContributedMenu","ContributedPillGroup","ContributedTab","FPSLink","MessageDialog","UnsavedChangesService"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-features.platform-ui-content"}}));