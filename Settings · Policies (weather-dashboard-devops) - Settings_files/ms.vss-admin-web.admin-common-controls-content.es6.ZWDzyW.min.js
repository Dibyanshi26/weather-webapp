"use strict";define("TFS/Admin/Common/Controls",["require","exports","react","VSSUI/Dialog","VSS/Platform/Layout","VSSUI/Link","VSS/Platform/Components/Format","VSSUI/TextField","VSS/Core/Util/String","VSS/Core/Observable","VSS/Platform/Identity","VSSUI/Button","VSSUI/List","VSSUI/Utilities/Provider","VSS/Features/PersonaImages/VssAuthenticatedPersona","TFS/Admin/Common/Providers/PersonaDetailsProvider","VSSUI/Persona","VSSUI/Observer","VSSUI/Pill","VSSUI/Table","TFS/Admin/Common/Constants/Constants","VSSUI/Status","VSSUI/FormItem","VSSUI/Checkbox","TFS/Admin/Common/Util/Telemetry/AdminTelemetry","TFS/Admin/Common/Constants/TelemetryConstants","VSS/Platform/Util/Url","VSS/Features/Identities/IdentityPickerProvider","VSS/Features/AuthenticatedIdentityPicker/AuthenticatedIdentityPicker","VSSUI/MessageBar","VSSUI/Panel","VSSUI/Spinner"],(function(e,t,s,r,a,o,i,n,l,c,m,p,h,u,d,g,C,P,b,D,v,j,f,E,N,S,x,L,M,w,y,U){var A,T,k,V;A=t[V="Resources"]={},t[V].LearnMoreLinkAriaLabel="Learn more.",t[V].DeleteButton="Delete",t[V].CancelButton="Cancel",t[V].DeleteMultiProjectDialogTitle="Delete projects",t[V].DeleteMultiProjectFirstParagraph="Are you sure you want to delete {0}?",t[V].DeleteMultiProjectSecondParagraph="You will have up to 28 days to recover these {0} projects. After, these projects will be deleted resulting in a loss of all project artifacts including work items, repos, teams, and builds. ",t[V].DeleteMultiProjectConfirmationText='To confirm this action, please type "{0}".',t[V].DeleteMultiProjectPlaceholderText="Type Confirm",t[V].DeleteSingleProjectPlaceholderText="Enter the project name",t[V].DeleteMultiProjectLearnMoreLink="https://aka.ms/az-delete-project",t[V].DeleteMultiProjectLearnMoreAriaLabel="Learn more about deleting projects.",t[V].DeleteMultiProjectErrorProjects="You do not have the permission to delete {0}.",t[V].ConfirmMessage="Confirm",t[V].DeleteProjectDialogTitle="Delete project",t[V].DeleteProjectFirstParagraph='Are you sure you want to delete the "{0}" project?',t[V].DeleteProjectSecondParagraph="You will have up to 28 days to recover this project. After, this project will be deleted resulting in a loss of all project artifacts including work items, repos, teams, and builds. ",t[V].DeleteProjectConfirmationText='To confirm this action, please type "{0}":',t[V].DeleteProjectPlaceholderText="Enter the project name",t[V].DeleteProjectLearnMoreLink="https://aka.ms/az-delete-project",t[V].DeleteProjectLearnMoreAriaLabel="Learn more about deleting projects.",t[V].FileSizeError="Uploaded file exceeds maximum size.",t[V].FileTypeError="Allowed file extensions are {0}.",t[V].Users="Users",t[V].MoreMembersLabel="{0} more",t[V].Add="Add",t[V].Cancel="Cancel",t[V].RenameButton="Save",t[V].CloseButton="Close",t[V].CurrentName="Current name:",t[V].NewNameMessage="Please retype the new name {0}",t[V].LearnMore="Learn more",t[V].AriaRenameText="Retype new name",t[V].ActionHeading="Action: ",t[V].StatusHeading="Status summary:",t[V].MultiOperationNameHeader="Group or user",t[V].MultiOperationStatusHeader="Status",t[V].MultiOperationMessageHeader="Message",t[V].OperationStatusSuccess="Succeeded",t[V].OperationStatusFailure="Failed",t[V].DeletionPartialSuccess="Deletion partial success",t[V].DeletionSuccess="Deletion succeeded",t[V].DeletionFailure="Deletion failed",t[V].ViewStatus="View status",t[V].Action="Action",t[V].InvalidRequestAccessUrl="Invalid Request Access Url. Example: https://www.contoso.com/requestaccess",t[V].RestoreMultiProjectDialogTitle="Restore projects",t[V].RestoreProjectDialogTitle="Restore project",t[V].UnableToRestoreProjects="We are unable to restore the project(s): {0} because the name(s) are currently in use.",t[V].AbleToRestoreProjects="Do you wish to continue restoring the projects(s): {0}?",t[V].RestoreMultiProjectConfirmationText='To confirm this action, please type "{0}".',t[V].RestoreMultiProjectPlaceholderText="Type organization name",t[V].RestoreMultiProjectLearnMoreLink="https://aka.ms/az-delete-project",t[V].RestoreMultiProjectLearnMoreAriaLabel="Learn more about restoring projects.",t[V].RestoreMultiProjectErrorProjects="You do not have the permission to delete {0}.",t[V].RestoreButton="Restore",t[V].RestoreProjectPlaceholderText="Type project name",t[V].suggesstionsContainerAriaLabel="Select users or groups",t[V].reasonDescription="Reason for owner change",t[V].reasonEmailNotice="An email will be sent to the Azure DevOps Administrators in Microsoft Entra notifying them of the change.",t[V].Close="Close",t[V].DefaultTitle="Users List",function(e){t[e]={};class i extends s.Component{constructor(e){super(e)}render(){return s.createElement(r.Dialog,{className:"confirmation-dialog",titleProps:{text:this.props.dialogTitle},onDismiss:this.props.onCancel,footerButtonProps:this._getFooterButtonProps()},s.createElement("div",{className:"confirmation-dialog-paragraph"},s.createElement("span",null,this.props.confirmationMessage)),null!=this.props.warningMessage&&s.createElement("div",{className:"confirmation-dialog-paragraph"},s.createElement("span",null,this.props.warningMessage),this.props.learnMoreLink&&s.createElement(o.Link,{href:this.props.learnMoreLink,target:"_blank",rel:"noopener noreferrer","aria-label":A.LearnMoreLinkAriaLabel},A.LearnMoreLinkAriaLabel)))}_getFooterButtonProps(){return[{text:A.CancelButton,onClick:this.props.onCancel},{disabled:!1,primary:!0,text:this.props.confirmationButtonLabel,onClick:()=>this.props.onItemConfirm()}]}}t[e].ConfirmationDialog=i,a.VssComponent.register("ms.vss-admin-web.confirmation-dialog",i)}("ConfirmationDialogConfirmationDialog"),function(e){t[e]={};class o extends s.Component{constructor(e){super(e)}render(){return s.createElement(r.Dialog,{titleProps:{text:this.props.dialogTitle},onDismiss:this.props.onCancel,footerButtonProps:this._getFooterButtonProps()},s.createElement("div",{className:"flex-column rhythm-vertical-8"},s.createElement("div",null,s.createElement(i.FormatComponent,{className:"delete-dialog-wrap",format:this.props.confirmationMessage},s.createElement("span",{className:"fontWeightSemiBold"},this.props.itemName),s.createElement("span",null,this.props.groupOrUserName))),s.createElement("div",null,this.props.warningMessage)))}_getFooterButtonProps(){var e=this.props.deleteButtonLabel?this.props.deleteButtonLabel:A.DeleteButton;return[{text:A.CancelButton,onClick:this.props.onCancel},{text:e,danger:!0,onClick:()=>this.props.onDeleteItemConfirm(this.props.itemToDelete)}]}}t[e].DeleteDialog=o,a.VssComponent.register("ms.vss-admin-web.delete-dialog",o)}("DeleteDialogDeleteDialog"),function(e){t[e]={};class m extends s.Component{constructor(e){super(e),this.inputConfirmText=new c.ObservableValue(""),this._onNameChanged=(e,t)=>{this.inputConfirmText.value=t,this._validateProjectName(t)},this._onKeyPress=e=>{13===e.which&&this.state.isMatch&&this.props.onDeleteProject()},this._validateProjectName=e=>{1==this.projectCount&&!(0,l.localeIgnoreCaseComparer)(e,this.props.projectNames[0])||this.projectCount>1&&!(0,l.localeIgnoreCaseComparer)(e,A.ConfirmMessage)?this.setState({isMatch:!0}):this.setState({isMatch:!1})},this.state={isMatch:!1,hasClicked:!1},this.projectList=this.props.projectNames.join(", "),this.projectCount=this.props.projectNames.length,this.noPermisionList=this.props.noPermissionProjectNames.join(", "),this.noPermisionCount=this.props.noPermissionProjectNames.length}render(){return s.createElement(r.Dialog,{calloutClassName:"delete-multi-project-dialog",titleProps:{text:this.projectCount>1?A.DeleteMultiProjectDialogTitle:A.DeleteProjectDialogTitle},onDismiss:()=>this.props.onCancel(),contentSize:2,footerButtonProps:[{text:A.Cancel,onClick:this.props.onCancel},{className:"delete-project-button",danger:!0,disabled:!this.state.isMatch,onClick:this.props.onDeleteProject,text:A.DeleteButton}]},s.createElement("div",null,this.noPermisionCount>0&&s.createElement("div",{className:"delete-project-error-paragraph"},s.createElement(i.FormatComponent,{format:A.DeleteMultiProjectErrorProjects,className:"project-list"},s.createElement("span",{className:"fontWeightSemiBold"},this.noPermisionList))),this.projectCount>0&&s.createElement(s.Fragment,null,s.createElement("div",{className:"delete-project-first-paragraph"},s.createElement(i.FormatComponent,{format:A.DeleteMultiProjectFirstParagraph,className:"project-list"},s.createElement("span",{className:"fontWeightSemiBold"},this.projectList))),s.createElement("div",{className:"delete-project-second-paragraph"},this.projectCount>1?s.createElement(i.FormatComponent,{format:A.DeleteMultiProjectSecondParagraph},s.createElement("span",{className:"delete-project-name fontWeightSemiBold"},this.projectCount)):A.DeleteProjectSecondParagraph,s.createElement(o.Link,{className:"learn-more-link",href:A.DeleteMultiProjectLearnMoreLink,target:"_blank",rel:"noopener noreferrer","aria-label":A.DeleteMultiProjectLearnMoreAriaLabel},A.DeleteMultiProjectLearnMoreAriaLabel)),s.createElement("div",{id:"delete-projects",className:"delete-project-action-paragraph"},s.createElement(i.FormatComponent,{format:A.DeleteMultiProjectConfirmationText},this.projectCount>1?s.createElement("span",{className:"delete-project-name fontWeightSemiBold"},A.ConfirmMessage):s.createElement("span",{className:"delete-project-name fontWeightSemiBold"},this.props.projectNames[0]))),s.createElement(n.TextField,{className:"org-name-text-field-margin",onKeyDown:this._onKeyPress,placeholder:this.projectCount>1?A.DeleteMultiProjectPlaceholderText:A.DeleteSingleProjectPlaceholderText,onChange:this._onNameChanged,disabled:0==this.projectCount,value:this.inputConfirmText,ariaLabelledBy:"delete-projects"}))))}}t[e].DeleteMultiDialog=m,a.VssComponent.register("ms.vss-admin-web.delete-multi-dialog",m)}("DeleteMultiDialogDeleteMultiDialog"),function(e){t[e]={};class m extends s.Component{constructor(e){super(e),this.projectName=new c.ObservableValue(""),this._onNameChanged=(e,t)=>{this.projectName.value=t,this._validateProjectName(t)},this._onKeyPress=e=>{13===e.which&&this.state.isMatch&&this.props.onDeleteProject()},this._validateProjectName=e=>{0===(0,l.localeIgnoreCaseComparer)(e,this.props.projectName)?this.setState({isMatch:!0}):this.setState({isMatch:!1})},this.state={isMatch:!1,hasClicked:!1}}render(){return s.createElement(r.Dialog,{calloutClassName:"delete-project-dialog",titleProps:{text:A.DeleteProjectDialogTitle},onDismiss:()=>this.props.onCancel(),footerButtonProps:[{text:A.Cancel,onClick:this.props.onCancel},{className:"delete-project-button",danger:!0,disabled:!this.state.isMatch,onClick:this.props.onDeleteProject,text:A.DeleteButton}]},s.createElement("div",{className:"delete-project-dialog-content"},s.createElement("div",{className:"delete-project-first-paragraph"},s.createElement(i.FormatComponent,{format:A.DeleteProjectFirstParagraph},s.createElement("span",{className:"delete-project-name fontWeightSemiBold"},this.props.projectName))),s.createElement("div",{className:"delete-project-second-paragraph"},A.DeleteProjectSecondParagraph,s.createElement(o.Link,{className:"learn-more-link",href:A.DeleteProjectLearnMoreLink,target:"_blank",rel:"noopener noreferrer","aria-label":A.DeleteProjectLearnMoreAriaLabel},A.DeleteProjectLearnMoreAriaLabel)),s.createElement("div",{className:"delete-project-action-paragraph"},s.createElement(i.FormatComponent,{format:A.DeleteProjectConfirmationText},s.createElement("span",{className:"delete-project-name fontWeightSemiBold"},this.props.projectName)))),s.createElement(n.TextField,{className:"delete-button-text-field",onKeyDown:this._onKeyPress,placeholder:A.DeleteProjectPlaceholderText,onChange:this._onNameChanged,value:this.projectName,ariaLabel:A.DeleteProjectPlaceholderText}))}}t[e].DeleteProjectDialog=m,a.VssComponent.register("ms.vss-admin-web.delete-project-dialog",m)}("DeleteProjectDialogDeleteProjectDialog"),function(e){t[e]={};class r extends s.Component{constructor(e,t){super(e,t),this.state={}}render(){let e=null;if(this.props.allowedFileExtensions){let t=this.props.allowedFileExtensions.map((e=>"."!==e[0]?"."+e:e));e=t.join(),this.validFileExtensions=t.join(", ")}return s.createElement("input",{type:"file",id:"idImage",style:{display:"none"},ref:e=>{this.input=e},onChange:e=>{this.fileSelected(e),e.target.value=""},accept:e})}fileSelected(e){let t=e.target.files,s=null;if(t&&t.length>0&&(s=t.item(0)),!s)return;let r=!1,a=s.name.split(".").pop();a="."+a;for(let e=0;e<this.props.allowedFileExtensions.length;e++)if(a.toLocaleLowerCase()===this.props.allowedFileExtensions[e].toLocaleLowerCase()){r=!0;break}let o="";r?s.size>this.props.maximumFileSize&&(o=A.FileSizeError):o=(0,l.format)(A.FileTypeError,this.validFileExtensions.toLocaleUpperCase());let i=[];const n=new FileReader;n.onload=e=>{if(e.target.readyState==FileReader.DONE)for(var t=e.target.result,s=t.split(",")[1],r=this._base64ToArrayBuffer(s),a=0;a<r.length;a++)i.push(r[a]);this.props.onload(t,i,o)},n.readAsDataURL(s)}_base64ToArrayBuffer(e){for(var t=window.atob(e),s=t.length,r=new Uint8Array(s),a=0;a<s;a++)r[a]=t.charCodeAt(a);return r}}t[e].FileSelectorInput=r}("FileSelectorInputFileSelectorInput"),function(e){T=t[e]={};class r extends s.Component{constructor(){super(...arguments),this._renderUserList=(e,t,r)=>s.createElement(h.ListItem,{key:"list-item-"+e,index:e,details:r},s.createElement("div",{className:"user-info-details flex-row flex-center"},s.createElement(d.VssAuthenticatedPersona,{identityDetailsProvider:{getIdentityImageUrl:e=>t.imageUrl||this._getUserImage(t.id),getDisplayName:()=>t.displayName},size:this.props.avatarSize?this.props.avatarSize:"large"}),s.createElement("div",{className:"left-margin"},s.createElement("div",{className:"fontWeightSemiBold"},t.displayName),s.createElement("div",{className:"grey-font"},t.preferredEmailAddress)),this.props.canDeleteMember&&s.createElement(p.Button,{className:"left-margin delete-button",subtle:!0,iconProps:{iconName:"Delete"},onClick:()=>this.props.onDeleteMember(t)})))}render(){return s.createElement(h.ScrollableList,{itemProvider:new u.ArrayItemProvider(this.props.users),renderRow:this._renderUserList,className:"width-100"})}_getUserImage(e){return(0,m.getIdentityImageUrl)(this.props.pageContext||this.context.pageContext,e)}}t[e].UsersListComponent=r,a.VssComponent.register("ms.vss-admin-web.users-list-component",r)}("UsersListDialogUsersListComponent"),function(e){k=t[e]={};class o extends a.VssComponent{render(){return s.createElement(r.Dialog,{calloutContentClassName:"user-dialog",onDismiss:this.props.onClose,footerButtonProps:[{onClick:this.props.onClose,text:A.Close}],titleProps:{text:this.props.title||A.DefaultTitle,className:"body-xl"}},s.createElement("div",null,s.createElement(T.UsersListComponent,{pageContext:this.props.pageContext,users:this.props.users,avatarSize:this.props.avatarSize?this.props.avatarSize:"large",canDeleteMember:this.props.canDeleteMember,onDeleteMember:this.props.onDeleteMember})))}}t[e].UsersListDialog=o,a.VssComponent.register("ms.vss-admin-web.users-list-dialog",o)}("UsersListDialogUsersListDialog"),function(e){t[e]={};class r extends s.Component{constructor(e,t){super(e,t),this._showListUsersDialog=new c.ObservableValue(!1),this.personaProvider=new g.PersonaDetailsProvider(this.props.pageContext),this.maxDisplayCount=this.props.maxIdentitiesToDisplayCount||this.props.identities.length}render(){return s.createElement(s.Fragment,null,s.createElement("div",{className:"entity-list"},s.createElement("div",{className:"entity-title"},s.createElement("h2",{className:"title-m title"},this.props.title||A.Users)),this.loadListPersonaElements(),this.props.identities&&this.props.identities.length>this.maxDisplayCount&&s.createElement("div",{className:"flex-row more-entities-pill"},s.createElement(b.Pill,{iconProps:{iconName:"Add"},onClick:()=>{this._showListUsersDialog.value=!0},size:1},s.createElement("span",{className:"more-entities-text"},l.format(A.MoreMembersLabel,this.props.identities.length-this.maxDisplayCount)))),this.props.identities&&this.props.identities.length>0&&s.createElement("div",{className:"empty-margin"}),s.createElement("div",null,s.createElement(p.Button,{disabled:!this.props.canAddMember,primary:!0,onClick:this.props.onAddMember},this.props.addButtonLabel||A.Add))),s.createElement(P.Observer,{showListUsersDialog:this._showListUsersDialog},(e=>e.showListUsersDialog&&s.createElement(k.UsersListDialog,{users:this.props.identities.value,title:this.props.title||A.Users,onClose:()=>{this._showListUsersDialog.value=!1},canDeleteMember:this.props.canDeleteMember,onDeleteMember:this.props.onDeleteMember}))))}loadListPersonaElements(){return this.props.identities.value.slice(0,this.maxDisplayCount).map((e=>{const t=this.castIdentityRefToIIdentity(e);return s.createElement(s.Fragment,{key:e.descriptor},s.createElement("div",{className:"person-panel-row flex-row","aria-label":e.displayName,"data-is-focusable":!0,key:e.descriptor},s.createElement(C.Persona,{size:40,identity:t,personaProvider:this.personaProvider}),s.createElement("div",{className:"flex-column"},s.createElement("label",{className:"persona-title"},e.displayName),s.createElement("label",{className:"persona-secondary-title"},e.preferredEmailAddress)),this.props.canDeleteMember&&s.createElement(p.Button,{className:"delete-button",subtle:!0,iconProps:{iconName:"Delete"},onClick:()=>this.props.onDeleteMember(e)})))}))}castIdentityRefToIIdentity(e){const t={};return t.localId=e.id,t.displayName=e.displayName,t.image=e.imageUrl,t.mail=e.preferredEmailAddress,t.subjectDescriptor=e.descriptor,t}}t[e].ListUsersAndManage=r,a.VssComponent.register("ms.vss-admin-web.list-users-and-manage-component",r)}("ListUsersAndManageListUsersAndManage"),function(e){t[e]={};class o extends s.Component{constructor(e){super(e)}render(){return s.createElement(r.Dialog,{calloutContentClassName:"multioperation-dialog",titleProps:{text:this.props.title,size:1},onDismiss:this.props.onCancel,footerButtonProps:[{disabled:!1,text:A.CloseButton,onClick:()=>this.props.onCancel()}],contentSize:2},s.createElement("div",{className:"multioperation"},s.createElement("div",{className:"multioperation-heading"},A.ActionHeading),s.createElement("div",null,this.props.statusText)),s.createElement("div",{className:"multioperation"},s.createElement("div",{className:"multioperation-heading"},A.StatusHeading),s.createElement("div",{className:"multioperation-container"},s.createElement(D.Table,{itemProvider:new c.ObservableArray(this.props.operations),columns:this.getColumns(),className:"permissons-table"}))))}getColumns(){return[{id:"Group",name:this.props.primaryColumnHeading,width:new c.ObservableValue(-60),columnStyle:1,renderCell:(e,t,s,r)=>this._renderCell(t,s,r.name)},{id:"Status",name:this.props.secondaryColumnHeading,width:new c.ObservableValue(-50),columnStyle:1,renderCell:(e,t,s,r)=>"string"==typeof r.value?this._renderCell(t,s,r.value):this._renderStatusCell(t,s,r.value)},{id:"Message",name:A.MultiOperationMessageHeader,width:new c.ObservableValue(-133),columnStyle:1,renderCell:(e,t,s,r)=>this._renderCell(t,s,r.message)}]}_renderCell(e,t,r){return s.createElement(D.SimpleTableCell,{columnIndex:e,tableColumn:t,key:e,contentClassName:"display-users-details"},s.createElement("span",{className:"multioperation-cell-text"},r))}_renderStatusCell(e,t,r){return s.createElement(D.SimpleTableCell,{columnIndex:e,tableColumn:t,key:e,contentClassName:"display-users-details"},s.createElement("span",{className:"multioperation-cell-text"},s.createElement(j.Status,Object.assign({},r===v.Result.Success?j.Statuses.Success:r===v.Result.Partial?j.Statuses.Warning:j.Statuses.Failed,{key:r.toString(),size:"16"}))))}}t[e].MultiOperationDialog=o,a.VssComponent.register("ms.vss-admin-web.multi-operation-dialog",o)}("MultiOperationDialogMultiOperationDialog"),function(e){t[e]={};class m extends a.VssComponent{constructor(e,t){super(e,t),this.telemetryLogger=new N.AdminTelemetry(this.context.pageContext),this._startActionCapture=(e,t)=>this.telemetryLogger.startActionCapture(S.Feature.OrganizationProjects,S.Feature.OrganizationProjects,e,t),this._onNameChanged=(e,t)=>{this.newName.value=t,this._validateProjectName()},this._getErrorMessage=()=>""===this.newName.value||this.props.validateName(this.newName.value)?""!==this.newName.value&&this.props.newName&&this.props.newName!==this.newName.value?(0,l.format)(A.NewNameMessage,this.props.newName):"":(0,l.format)(this.props.invalidNameMessage,this.newName.value),this._validateProjectName=()=>{!this.props.validateName(this.newName.value)||this.props.newName&&this.props.newName!==this.newName.value?this.setState({isValid:!1}):this.setState({isValid:!0})},this._onRenameDialogRenameClick=e=>{const t=this.newName&&this.newName.value;t&&this.props.onRename(t)},this._onChecked=(e,t)=>{this.setState({confirmChecked:new c.ObservableValue(t)})},this.state={confirmChecked:new c.ObservableValue(!1),isValid:!1},this.newName=new c.ObservableValue("")}render(){let e=this._getErrorMessage();return s.createElement(r.Dialog,{onDismiss:()=>{this.props.onCancel()},contentSize:2,className:"rename-dialog",titleProps:{text:this.props.renameDialogTitle,className:"fontWeightSemiBold"},footerButtonProps:[{text:A.Cancel,onClick:()=>{this.props.onCancel()}},{disabled:!this.state.confirmChecked.value||!this.state.isValid,text:A.RenameButton,onClick:this._onRenameDialogRenameClick,primary:!0}]},s.createElement("div",{className:"flex-column"},s.createElement("div",{id:"rename-primary-paragraph"},this.props.renameDialog1),s.createElement(i.FormatComponent,{elementType:"div",className:"rename-second-paragraph",format:this.props.renameDialog2},s.createElement("span",{className:"fontWeightSemiBold"},this.props.url),s.createElement("span",null,s.createElement(o.Link,{target:"_blank",rel:"noopener noreferrer",href:this.props.renameDialog2Link},A.LearnMore))),s.createElement("div",{className:"rename-current-name"},s.createElement("span",{className:"fontWeightSemiBold"},A.CurrentName)," ",this.props.name),s.createElement(f.FormItem,{className:"rename-textfield",label:s.createElement("span",{className:"fontWeightSemiBold"},this.props.renameNewName),message:e,error:""!==e},s.createElement(n.TextField,{value:this.newName,onChange:this._onNameChanged,placeholder:this.props.newName,ariaLabel:A.AriaRenameText})),s.createElement(E.Checkbox,{label:this.props.renameConfirmationText,checked:this.state.confirmChecked,className:"confirm",onChange:this._onChecked})))}}t[e].RenameDialog=m,a.VssComponent.register("ms.vss-admin-web.rename-dialog",m)}("RenameDialogRenameDialog"),function(e){t[e]={};class i extends s.Component{constructor(e){super(e),this._onUrlSave=e=>{this.props.onSave(e)},this._onUrlChanged=(e,t)=>{if(this.setState({userInputUrl:new c.ObservableValue(t)}),t)try{const e=new x.Uri(t,{absoluteUriRequired:!0});e.absoluteUri&&(l.equals(e.scheme,"http",!0)||l.equals(e.scheme,"https",!0))?this.setState({invalidUrl:new c.ObservableValue(!1),emptyUrl:new c.ObservableValue(!1)}):this.setState({invalidUrl:new c.ObservableValue(!0),emptyUrl:new c.ObservableValue(!1)})}catch(e){this.setState({invalidUrl:new c.ObservableValue(!0),emptyUrl:new c.ObservableValue(!1)})}else this.setState({emptyUrl:new c.ObservableValue(!0),invalidUrl:new c.ObservableValue(!1)})},this.state={invalidUrl:new c.ObservableValue(!1),emptyUrl:this.props.requestAccessUrl?new c.ObservableValue(!1):new c.ObservableValue(!0),userInputUrl:new c.ObservableValue(this.props.requestAccessUrl)}}render(){return this.errorMessage=this._getUrlErrorMessage(),s.createElement(r.Dialog,{className:"requestaccess-dialog",titleProps:{text:this.props.requestAccessTitle},onDismiss:this.props.onCancel,footerButtonProps:this._getFooterButtonProps()},s.createElement("div",{className:"requestaccess-dialog-paragraph small-top-margin"},s.createElement("span",null,this.props.requestAccessMessage),this.props.requestAccessLearnMoreLink&&s.createElement(o.Link,{href:this.props.requestAccessLearnMoreLink,target:"_blank",rel:"noopener noreferrer","aria-label":A.LearnMoreLinkAriaLabel},A.LearnMoreLinkAriaLabel)),s.createElement(f.FormItem,{className:"top-margin",message:this.errorMessage,error:this.state.invalidUrl},s.createElement(n.TextField,{onChange:this._onUrlChanged,value:this.state.userInputUrl})))}_getFooterButtonProps(){return[{text:A.CancelButton,onClick:this.props.onCancel},{disabled:this.state.invalidUrl.value||this.state.emptyUrl.value,primary:!0,text:this.props.saveButtonLabel,onClick:()=>this._onUrlSave(this.state.userInputUrl.value)}]}_getUrlErrorMessage(){return this.state.userInputUrl&&this.state.invalidUrl.value?A.InvalidRequestAccessUrl:""}}t[e].RequestAccessDialog=i,a.VssComponent.register("ms.vss-admin-web.requestaccess-dialog",i)}("RequestAccessDialogRequestAccessDialog"),function(e){t[e]={};class o extends s.Component{constructor(e){super(e),this.restorableProjectsList=this.props.restorableProjects.join(", "),this.restorableProjectsCount=this.props.restorableProjects.length,this.unrestorableProjectsList=this.props.unrestorableProjects.join(", "),this.unrestorableProjectsCount=this.props.unrestorableProjects.length}render(){return s.createElement(r.Dialog,{calloutClassName:"restore-multi-project-dialog",titleProps:{text:this.restorableProjectsCount>1||this.unrestorableProjectsCount>1?A.RestoreMultiProjectDialogTitle:A.RestoreProjectDialogTitle},onDismiss:()=>this.props.onCancel(),contentSize:2,footerButtonProps:[{text:A.Cancel,onClick:this.props.onCancel},{className:"restore-project-button",primary:!0,onClick:this.props.onRestoreProject,text:A.RestoreButton,disabled:this.restorableProjectsCount<1}]},s.createElement("div",null,s.createElement("div",{className:"restore-project-first-paragraph"},s.createElement(i.FormatComponent,{format:A.UnableToRestoreProjects,className:"project-list"},s.createElement("span",{className:"fontWeightSemiBold"},this.unrestorableProjectsList))),this.restorableProjectsCount>0&&s.createElement("div",{className:"restore-project-first-paragraph"},s.createElement(i.FormatComponent,{format:A.AbleToRestoreProjects,className:"project-list"},s.createElement("span",{className:"fontWeightSemiBold"},this.restorableProjectsList)))))}}t[e].RestoreMultiDialog=o,a.VssComponent.register("ms.vss-admin-web.restore-multi-dialog",o)}("RestoreProjectsDialogRestoreProjectsDialog"),function(e){t[e]={};class r extends a.VssComponent{constructor(e){super(e),this._selectedUser=new c.ObservableValue(void 0),this.reason=new c.ObservableValue(""),this._onUserChangeValidation=e=>{if(e){const t=this.props.onUserChange(e);if(t.enableActionButton&&(this._selectedUser.value=e),t.hasError){const e=t.errorTextType;this.setState({hasError:t.hasError,errorComponent:t.errorComponent,errorTextType:e||"Error",enableActionButton:t.enableActionButton})}else this.setState({hasError:!1,errorComponent:s.createElement(s.Fragment,null),enableActionButton:t.enableActionButton});return!0}return this._selectedUser.value=e,this.setState({hasError:!1,enableActionButton:!1}),!1},this._onClick=e=>{this.setState({updateInProgress:!0}),this.props.onSelectUser(this._selectedUser.value,this.reason.value)},this.state={hasError:!1,errorTextType:"Error",enableActionButton:!1,updateInProgress:!1},this._pickerProvider=new L.PeoplePickerProvider(this.props.pageContext,{identityTypes:this.props.identityTypesToLookup||["user"],options:{MinResults:5,MaxResults:20}})}render(){return s.createElement(y.Panel,{showSeparator:!1,onDismiss:this.props.onCancel,titleProps:{text:this.props.panelTitle},description:this.props.panelDescription,defaultActiveElement:".select-user-picker input",footerButtonProps:[{text:A.Cancel,onClick:()=>{this.props.onCancel()}},{text:this.props.actionButtonText,primary:!0,onClick:this._onClick,disabled:!this.state.enableActionButton||this.state.updateInProgress||this.props.requestReason&&0===this.reason.value.length}]},s.createElement("div",{className:"flex-column select-user"},s.createElement("div",{className:"flex-column"},s.createElement(M.AuthenticatedIdentityPickerDropdown,{className:"select-user-picker",pickerProvider:this._pickerProvider,onChange:this._onUserChangeValidation,suggestionsContainerAriaLabel:A.suggesstionsContainerAriaLabel,value:this._selectedUser,placeholder:this.props.selectUserPlaceHolderText,editPlaceholder:this.props.selectUserEditPlaceHolderText}),this.state.hasError?s.createElement(w.MessageBar,{className:"user-error",severity:this.state.errorTextType},this.state.errorComponent):null,this.props.requestReason?s.createElement(s.Fragment,null,s.createElement(n.TextField,{className:"margin-top-16 change-owner-reason",ariaLabel:A.reasonDescription,value:this.reason,multiline:!0,placeholder:A.reasonDescription,onChange:(e,t)=>{this.reason.value=t,this.setState({enableActionButton:this.state.enableActionButton})},maxLength:256}),s.createElement("div",{className:"margin-top-8"},A.reasonEmailNotice)):null),this.state.updateInProgress?s.createElement(U.Spinner,{className:"select-user-spinner",size:"large"}):null))}}t[e].SelectUserPanel=r,a.VssComponent.register("ms.vss-admin-web.select-user-panel",r)}("SelectUserPanelSelectUserPanel")}),["Resources","ConfirmationDialog/ConfirmationDialog","DeleteDialog/DeleteDialog","DeleteMultiDialog/DeleteMultiDialog","DeleteProjectDialog/DeleteProjectDialog","FileSelectorInput/FileSelectorInput","UsersListDialog/UsersListComponent","UsersListDialog/UsersListDialog","ListUsersAndManage/ListUsersAndManage","MultiOperationDialog/MultiOperationDialog","RenameDialog/RenameDialog","RequestAccessDialog/RequestAccessDialog","RestoreProjectsDialog/RestoreProjectsDialog","SelectUserPanel/SelectUserPanel"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-admin-web.admin-common-controls-content"}}));