"use strict";define("TFS/CreateProject",["require","exports","VSS/Reflux/Action","VSS/Core/Util/String","VSS/Platform/Trace","VSS/Platform/Context","VSS/Platform/RestClientBase","VSS/Core/Util/Promise","VSS/Core/Util/Accessibility","VSS/Platform/Feature","VSS/Platform/Location","react","VSS/Core/Util/Object","VSS/Platform/Layout","VSSUI/Button","Tfs/Platform/Resources","VSS/Platform/Components/Format","OfficeFabric/Label","OfficeFabric/TextField","VSSUI/ButtonGroup","VSSUI/Spinner","VSS/Core/Observable","VSSUI/TextField","VSSUI/FormItem","VSSUI/MessageBar","VSSUI/Icon","VSSUI/RadioButton","VSSUI/Util","VSSUI/MessageCard","VSS/Reflux/Store","OfficeFabric/Fabric","VSSUI/Link","VSSUI/Panel","OfficeFabric/Overlay"],(function(e,t,s,i,o,a,r,n,c,l,p,d,u,h,m,C,g,j,P,_,S,v,b,y,f,T,x,N,V,E,L,w,O,M){var F,A,I,D,k,R,B,H,U,W,G,z,K,q,Y,X,$,J,Q,Z,ee,te;F=t[te="Resources"]={},t[te].CreateProjectCancelButtonText="Cancel",t[te].CreateProjectCollectionNameContainerHeader="Collection name",t[te].CreateProjectCTAButtonText="Create project",t[te].CreateProjectWithCancelCTAButtonText="Create",t[te].CreateProjectDescriptionContainerHeader="Description",t[te].CreateProjectFormHeader="Create new project",t[te].CreateProjectNameContainerHeader="Project name",t[te].CreateProjectNameNotAvailableText="The project '{0}' already exists.",t[te].CreateProjectProjectVisibilitySectionHeader="Visibility",t[te].CreateProjectOperationFailedErrorText="Project creation operation failed. Please retry project creation.",t[te].LoadingText="Loading...",t[te].CreateProjectAdvancedOptionsText="Advanced",t[te].CreateProjectCreateCTAButtonToolTip="Create project",t[te].CreatingProjectAnnouncementMessage="Creating project",t[te].ProjectDecriptionTextFieldAriaDescription="Enter a brief description for your project. This field is optional.",t[te].CreateProjectNameAriaDescription="Enter a memorable name for your project.",t[te].CreateProjectGenericServerErrorText="We are having trouble loading the content.",t[te].CollapsibleMessageHideDetails="Hide details",t[te].CollapsibleMessageShowDetails="Show details",t[te].CreateProjectUnauthorizedAccessText="You do not have sufficient permissions to create a new project. Please contact the organization administrator for support.",t[te].CreateProjectOperationFailedErrorTextOnPrem="Project creation operation failed.",t[te].RetrieveCreateProjectFailureTextAfterHere="to download full logs.",t[te].RetrieveCreateProjectFailureTextHere="here",t[te].RetrieveCreateProjectFailureTextPreHere="Click",t[te].CreateProjectCodeOfConductLink="https://aka.ms/vstscodeofconduct",t[te].CreateProjectCodeOfConductStatement="By creating this project, you agree to the {0} {1}",t[te].CreateProjectCodeOfConductText="code of conduct",t[te].CreateProjectDisabledProjectVisibilityTooltip="Your organization doesn't allow {0} projects.",t[te].CreateProjectPolicyMessage="Public projects are disabled for your organization. You can turn on public visibility with {0}.",t[te].CreateProjectPolicyLinkText="organization policies",t[te].CreateProjectInvalidVisibilityValue="{0} is not a valid visibility value.",t[te].CreateProjectOrganizationVisibilityOptionDescription="Members of your enterprise can view the project.",t[te].CreateProjectOrganizationVisibilityText="Enterprise",t[te].CreateProjectPrivateVisibilityOptionDescription="Only people you give access to will be able to view this project.",t[te].CreateProjectPrivateVisibilityText="Private",t[te].CreateProjectPublicVisibilityOptionDescription="Anyone on the internet can view the project. Certain features like TFVC are not supported.",t[te].CreateProjectPublicVisibilityText="Public",t[te].UnknownOperationStateErrorMessage="Unknown operation state",t[te].ProjectNameErrorMessage_EmptyName="Project name cannot be empty",t[te].ProjectNameErrorMessage_MaxLengthCrossed="Project name can be a maximum of 64 characters",t[te].ProjectNameErrorMessage_InvalidStartingChar="Project name cannot start with '.' or '_'",t[te].ProjectNameErrorMessage_InvalidEndingChar="Project name cannot end with '.'",t[te].ProjectNameErrorMessage_InvalidChar="Project name cannot contain '{0}'",t[te].ProjectNameErrorMessage_ReservedNameNotAllowed="'{0}' is reserved. It cannot be used as project name.",t[te].TryAgainButtonText="Try again",t[te].GoBackButtonText="Go Back",t[te].CreatingNewProjectMessage="New project is being created...",t[te].GenericErrorMessage="Oops, something went wrong.",t[te].DownloadLogsMessage="Click {0} to download full logs.",t[te].HereText="here",t[te].ReportingServiceWarningUrl="https://go.microsoft.com/fwlink/?linkid=852483",t[te].ReportingServiceWarningMessage="Reports are not created automatically. {0} how you can create your reports afterwards.",t[te].FindOutText="Find out",t[te].ProjectLimitErrorMessage_OverLimit="You may not add a project as this organization already has {0} projects. Please delete unused projects to reduce total project count to under {1} or switch to another organization. Learn more about project limits: {2}",t[te].ProjectLimitErrorMessage_OverWarning="Your organization has {0} or more projects. Users of this organization may experience performance issues in older versions of Visual Studio and Excel integration when supporting over {1} projects. Azure DevOps supports up to a maximum of {2} projects. Learn more about project limits: {3}",t[te].ProjectLimitErrorMessage_OverPerformanceWarning="Your organization has {0} projects, and you are limited to having no more than {1} projects. Learn more about project limits: {2}",t[te].ProjectLimitDocUrl="https://aka.ms/projectlimits",t.Models={},function(e){A=t[e]={};t[e].ActionsHub=class{constructor(){this.projectCreationMetadataLoadStarted=new s.Action,this.projectCreationMetadataLoadSucceeded=new s.Action,this.projectCreationMetadataLoadFailed=new s.Action,this.existingProjectNamesFetched=new s.Action,this.projectCreationStarted=new s.Action,this.projectCreationSucceeded=new s.Action,this.projectCreationFailed=new s.Action,this.projectNameValidationSucceeded=new s.Action,this.projectNameValidationFailed=new s.Action,this.projectNameValidationReset=new s.Action,this.projectLimitCheckSucceeded=new s.Action,this.projectLimitCheckFailed=new s.Action,this.projectDescriptionChanged=new s.Action,this.versionControlChanged=new s.Action,this.projectVisibilityChanged=new s.Action,this.processTemplateChanged=new s.Action,this.statusMessageDismissed=new s.Action,this.advancedOptionVisibilityToggled=new s.Action}}}("ActionsHub"),function(e){I=t[e]={},function(e){e.Area="CreateProjectPanel",e.ProjectCreationDataProvider="ms.vss-tfs-web.create-project-data-provider",e.ProjectNamesDataProvider="ms.vss-tfs-web.project-names-data-provider",e.ProjectOverviewRoute="ms.vss-tfs-web.project-overview-route",e.MembersActionParam="members",e.DefafultProcessTemplate="860fc3a4-aaeb-42b9-a8ec-8d2c189b106c",e.DisableProjectLimitFeatureFlag="Project.Creation.DisableProjectLimitCheck",e.ProjectLimitSharedDataName="ProjectLimitFromRegistry",e.ProjectWarningSharedDataName="ProjectWarningFromRegistry",e.DisablePerformanceWarningFeatureFlag="Project.Creation.DisableProjectPerformanceWarning"}(t[e].Constants||(t[e].Constants={})),function(e){e.MaxProjectNameLength=64,e.MaxProjectDescriptionLength=15999}(t[e].ProjectParameterConstants||(t[e].ProjectParameterConstants={})),function(e){e.EveryoneInTenant="EveryoneInTenant",e.TeamMembers="TeamMembers",e.Everyone="Everyone"}(t[e].ProjectVisibilityConstants||(t[e].ProjectVisibilityConstants={}))}("Constants"),function(e){D=t[e]={};const s=["server","bin","App_code","App_Browsers","App_Data","App_GlobalResources","App_LocalResources","App_Themes","App_WebReferences","web.config","SignalR"],o=["prn","com1","com2","com3","com4","com5","com6","com7","com8","com9","com10","lpt1","lpt2","lpt3","lpt4","lpt5","lpt6","lpt7","lpt8","lpt9","nul","con","aux",".",".."],a=["@","~",";","{","}","'","+","=",",","<",">","|","/","\\","?",":","&","$","*",'"',"#","[","]","&","%","\0","","","","","","","","\b","\t","\n","\v","\f","\r","","","","","","","","","","","","","","","","","","",""];t[e].validateProjectName=function(e){let t=0;const r={isValid:!0,invalidNameReason:""};if(null===e||0===e.length)r.isValid=!1,r.invalidNameReason=F.ProjectNameErrorMessage_EmptyName;else if(e.length>64)r.isValid=!1,r.invalidNameReason=F.ProjectNameErrorMessage_MaxLengthCrossed;else if("_"===e.substring(0,1)||"."===e.substring(0,1))r.isValid=!1,r.invalidNameReason=F.ProjectNameErrorMessage_InvalidStartingChar;else if("."===e.charAt(e.length-1))r.isValid=!1,r.invalidNameReason=F.ProjectNameErrorMessage_InvalidEndingChar;else{const n=[];for(t=0;t<a.length;t++){const s=a[t];-1!==e.indexOf(s)&&(r.isValid=!1,-1===n.indexOf(s)&&n.push(s))}if(r.isValid){const a=[...o,...s];for(t=0;t<a.length;t++)if((0,i.equals)(e,a[t],!0)){r.isValid=!1,r.invalidNameReason=(0,i.format)(F.ProjectNameErrorMessage_ReservedNameNotAllowed,e);break}}else r.invalidNameReason=(0,i.format)(F.ProjectNameErrorMessage_InvalidChar,n.join("','"))}return r}}("ProjectNameValidator"),function(e){k=t[e]={};t[e].ApiSource=class{constructor(e){this._pageContext=e}createProject(e){const t={name:e.projectName,description:e.projectDescription,visibility:this._getProjectVisibility(e.projectVisibilityOption),capabilities:{versioncontrol:{sourceControlType:e.versionControlOption},processTemplate:{templateTypeId:e.processTemplateTypeId},features:e.featureIds&&e.featureIds.length?{featuresEnabled:e.featureIds.join(",")}:void 0}},s=this._pageContext.getService("IVssPerformanceService"),i="CreateProjectPanel.ApiSource.CreateProject";return s.startScenario(i,!1),this.coreRestClient.queueCreateProject(t).then((e=>(s.endScenario(I.Constants.Area,i,!1),e)),(e=>{throw s.endScenario(I.Constants.Area,i,!1,void 0,{status:"failed"}),o.traceError(this._pageContext,I.Constants.Area,"CreateProjectPanel.ApiSource.CreateProject.Failed",e.message,{error:e}),e}))}_getProjectVisibility(e){switch(e){case I.ProjectVisibilityConstants.TeamMembers:return 0;case I.ProjectVisibilityConstants.EveryoneInTenant:return 1;case I.ProjectVisibilityConstants.Everyone:return 2;default:throw new Error(i.format(F.CreateProjectInvalidVisibilityValue,e))}}get coreRestClient(){return this._coreRestClient||(this._coreRestClient=this._pageContext.getRestClient("ICoreRestClient")),this._coreRestClient}}}("SourcesApiSource"),function(e){R=t[e]={};t[e].DataProviderSource=class{constructor(e){this._pageContext=e}getInitialData(e){const t=this._pageContext.getService("IVssPerformanceService"),s="CreateProjectPanel.DataProviderSource.GetInitialData";return t.startScenario(s,!1),this._pageContext.getService("IVssContributionService").getDataAsync(I.Constants.ProjectCreationDataProvider,void 0,e).then((e=>(t.endScenario(I.Constants.Area,s,!1),e)),(e=>{throw t.endScenario(I.Constants.Area,s,!1,void 0,{status:"failed"}),o.traceError(this._pageContext,I.Constants.Area,"CreateProjectPanel.DataProviderSource.GetInitialData.Failed",e.message,{error:e}),new Error(F.CreateProjectGenericServerErrorText)}))}getExistingProjects(){const e=this._pageContext.getService("IVssPerformanceService"),t="CreateProjectPanel.DataProviderSource.GetExistingProjects";return e.startScenario(t,!1),this._pageContext.getService("IVssContributionService").getDataAsync(I.Constants.ProjectNamesDataProvider,void 0,!0).then((s=>(e.endScenario(I.Constants.Area,t,!1),s)),(s=>{e.endScenario(I.Constants.Area,t,!1,void 0,{status:"failed"}),o.traceError(this._pageContext,I.Constants.Area,"CreateProjectPanel.DataProviderSource.GetExistingProjects.Failed",s.message,{error:s})}))}}}("SourcesDataProviderSource"),function(e){t[e]={};class s extends r.RestClientBase{constructor(e){super(e)}async getOperation(e,t){const s={pluginId:t};return this.beginRequest({apiVersion:"4.1-preview.1",routeTemplate:"_apis/operations/{operationId}",routeValues:{operationId:e},queryParams:s})}}t[e].OperationsClientName="Operations_CreateProject.IOperationsRestClient",t[e].getOperationsClient=function(s,i){return s.getRestClient(t[e].OperationsClientName,i)},a.RestClients.add(t[e].OperationsClientName,{factory:s})}("GeneratedRestClientOperations"),function(e){B=t[e]={};t[e].OperationResultSource=class{constructor(e){this._pageContext=e,this.operationStatusPollTimeout=2e3}get operationsClient(){return this._operationsRestClient||(this._operationsRestClient=this._pageContext.getRestClient("Operations_CreateProject.IOperationsRestClient")),this._operationsRestClient}pollOperationResult(e){return this.operationsClient.getOperation(e).then((t=>{switch(t.status){case 0:case 1:case 2:return(0,n.wait)(this.operationStatusPollTimeout).then((()=>this.pollOperationResult(e)));case 4:return{isOperationResultSuccess:!0};case 5:case 3:return{isOperationResultSuccess:!1,resultMessage:t.resultMessage,resultUrl:t.resultUrl?t.resultUrl.resultUrl:void 0};default:throw new Error(F.UnknownOperationStateErrorMessage)}}),(e=>{throw o.traceError(this._pageContext,I.Constants.Area,"CreateProjectPanel.OperationResultSource.PollOperationResult.Failed",e.message,{error:e}),e}))}}}("SourcesOperationResultSource"),function(e){H=t[e]={};t[e].ActionCreator=class{constructor(e,t,s,i,o,a){this._actionsHub=e,this._pageContext=t,this._apiSource=s,this._operationResultSource=i,this._dataProviderSource=o,this.onCreateProjectComplete=a,this.projectLimit=1e3,this.projectWarning=250,this.projectPerformanceWarningThreshold=75,this.updateProjectDescription=e=>{this._actionsHub.projectDescriptionChanged.invoke(e)},this.updateVersionControlType=e=>{this._actionsHub.versionControlChanged.invoke(e)},this.updateProjectVisibilityOption=e=>{this._actionsHub.projectVisibilityChanged.invoke(e)},this.updateProcessTemplate=e=>{this._actionsHub.processTemplateChanged.invoke(e)},this.reloadPanel=()=>{this.fetchProjectCreationMetadata(!0),this.fetchExistingProjectNames()},this.dismissStatusMessage=()=>{this._actionsHub.statusMessageDismissed.invoke(void 0)},this.toggleAdvancedOptionsVisibility=()=>{this._actionsHub.advancedOptionVisibilityToggled.invoke(void 0)},this.getProjectLimitFeatureFlag=()=>(0,l.isFeatureFlagEnabled)(this._pageContext,I.Constants.DisableProjectLimitFeatureFlag,!1),this._invokeProjectMetadataLoadFailedAction=e=>{this._actionsHub.projectCreationMetadataLoadFailed.invoke({pageStatus:{value:2,message:e.message},statusMessage:{message:e.message,statusMessageType:3,showGoBackCta:!1,showTryAgainCta:!0}})};const r=this._pageContext.getService("IVssPageService").getData();this._isHosted=!!r&&r.isHosted}get apiSource(){return this._apiSource||(this._apiSource=new k.ApiSource(this._pageContext)),this._apiSource}get dataProviderSource(){return this._dataProviderSource||(this._dataProviderSource=new R.DataProviderSource(this._pageContext)),this._dataProviderSource}get operationResultSource(){return this._operationResultSource||(this._operationResultSource=new B.OperationResultSource(this._pageContext)),this._operationResultSource}fetchProjectCreationMetadata(e){this._actionsHub.projectCreationMetadataLoadStarted.invoke({pageStatus:{value:3,message:""},statusMessage:{message:"",statusMessageType:0,showGoBackCta:!1,showTryAgainCta:!1}}),this.dataProviderSource.getInitialData(e).then((e=>{if(e&&(!e.canUserCreateProject||e.canUserCreateProject&&e.defaultVersionControlType&&e.defaultProcessTemplate)){const t={value:1,message:""},s={message:"",statusMessageType:0,showGoBackCta:!1,showTryAgainCta:!1};e.canUserCreateProject||(s.statusMessageType=2,s.showTryAgainCta=!1,s.message=t.message=F.CreateProjectUnauthorizedAccessText,t.value=2,(0,c.announce)(i.format("{0} {1}",F.GenericErrorMessage,F.CreateProjectUnauthorizedAccessText))),this._actionsHub.projectCreationMetadataLoadSucceeded.invoke({projectCreationMetadata:e,pageStatus:t,statusMessage:s})}else this._invokeProjectMetadataLoadFailedAction(new Error(F.CreateProjectGenericServerErrorText))}),this._invokeProjectMetadataLoadFailedAction)}fetchExistingProjectNames(){this.dataProviderSource.getExistingProjects().then((e=>{if(e&&e.existingProjectNames){const t=e.existingProjectNames;t.length>0&&this._actionsHub.existingProjectNamesFetched.invoke(t)}}))}resetProjectNameValidation(){this._actionsHub.projectNameValidationReset.invoke({projectName:"",status:{value:0,message:""}})}validateAndUpdateProjectName(e,t){const s=this._validateProjectName(e,t);s.isValid?this._actionsHub.projectNameValidationSucceeded.invoke({projectName:e,status:{value:1,message:""}}):e&&this._actionsHub.projectNameValidationFailed.invoke({projectName:e,status:{value:2,message:s.invalidNameReason}})}checkProjectLimit(){this.dataProviderSource.getExistingProjects().then((e=>{let t,s,o;const a={isBelowLimit:!1,isBelowWarning:!1,errorReason:""};if(e){const r=e.limit;s=null!=r?r:this.projectLimit;const n=e.warning;t=null!=n?n:this.projectWarning;const c=e.performanceWarning;o=null!=c?c:this.projectPerformanceWarningThreshold;const p=Math.ceil(s*(o/100)),d=(0,l.isFeatureFlagEnabled)(this._pageContext,I.Constants.DisablePerformanceWarningFeatureFlag,!1),u=e.existingProjectNames;u&&u.length>0?t<=u.length&&(d||u.length<p)&&u.length<s?(a.isBelowLimit=!0,a.isBelowWarning=!1,a.errorReason=(0,i.format)(F.ProjectLimitErrorMessage_OverWarning,u.length,p,s,F.ProjectLimitDocUrl)):!d&&p<=u.length&&u.length<s?(a.isBelowLimit=!0,a.isBelowWarning=!1,a.errorReason=(0,i.format)(F.ProjectLimitErrorMessage_OverPerformanceWarning,u.length,s,F.ProjectLimitDocUrl)):u.length>=s&&u.length>t?(a.isBelowLimit=!1,a.isBelowWarning=!1,a.errorReason=(0,i.format)(F.ProjectLimitErrorMessage_OverLimit,u.length,s,F.ProjectLimitDocUrl)):(a.isBelowLimit=!0,a.isBelowWarning=!0):u&&0!=u.length||(a.isBelowLimit=!0,a.isBelowWarning=!0),a&&a.isBelowLimit?this._actionsHub.projectLimitCheckSucceeded.invoke({isBelowLimit:a.isBelowLimit,isBelowWarning:a.isBelowWarning,status:{value:1,message:a.errorReason}}):this._actionsHub.projectLimitCheckFailed.invoke({isBelowLimit:a.isBelowLimit,isBelowWarning:a.isBelowWarning,status:{value:2,message:a.errorReason}})}}))}createProject(e,t,s,i,o){if(e.projectName!==t){if(!this._validateProjectName(t,s).isValid)return;e.projectName=t.trim()}const a=this._pageContext.getService("IVssPerformanceService"),r="CreateProjectPanel.CreateProjectInitiated";a.startScenario(r,!1);const n=e.projectName;this._actionsHub.projectCreationStarted.invoke({projectName:n,navigationUrl:"",creationStatus:{value:3,message:F.CreatingNewProjectMessage},statusMessage:{message:F.CreatingNewProjectMessage,statusMessageType:1,showGoBackCta:!1,showTryAgainCta:!1}}),this.apiSource.createProject(e).then((t=>{i?(a.endScenario(I.Constants.Area,r,!1),this.handleCreateProjectSuccess(e,i,o)):this.operationResultSource.pollOperationResult(t.id).then((s=>{if(s.isOperationResultSuccess)a.endScenario(I.Constants.Area,r,!1),this.handleCreateProjectSuccess(e,void 0,o);else{this._abortPerformanceScenario(a,r);const e=this._isHosted?F.CreateProjectOperationFailedErrorText:F.CreateProjectOperationFailedErrorTextOnPrem;this._invokeProjectCreationFailedAction(n,new Error(e),s.resultMessage,this._isHosted?void 0:s.resultUrl,t.id)}}),(e=>{this._abortPerformanceScenario(a,r),this._invokeProjectCreationFailedAction(n,e)}))}),(e=>{this._abortPerformanceScenario(a,r),this._invokeProjectCreationFailedAction(n,e)}))}handleCreateProjectSuccess(e,t,s){if(!s){let s=I.Constants.ProjectOverviewRoute;if(e.featureIds&&1===e.featureIds.length){const t=this._pageContext.getService("ITfsProductFeaturesService").getProduct(e.featureIds[0]);s=t?t.acquisitionRouteId||t.defaultRouteId:s}const i=(0,p.routeUrl)(this._pageContext,s,{project:t||e.projectName});this._invokeProjectCreationSucceededAction(e.projectName,i,F.CreatingNewProjectMessage)}this.onCreateProjectComplete&&this.onCreateProjectComplete(e.projectName)}_abortPerformanceScenario(e,t){e.endScenario(I.Constants.Area,t,!1,void 0,{status:"failed"})}_validateProjectName(e,t){let s={isValid:!0,invalidNameReason:""};if(e){const o=e.trim();s=(0,D.validateProjectName)(o),s.isValid&&t[o.toLowerCase()]&&(s.isValid=!1,s.invalidNameReason=i.format(F.CreateProjectNameNotAvailableText,o))}else s.isValid=!1,s.invalidNameReason=F.ProjectNameErrorMessage_EmptyName;return s}_invokeProjectCreationFailedAction(e,t,s,i,o){const a=t.serverError&&t.serverError.typeKey,r=-1!==["ArgumentException","ProjectAlreadyExistsException","InvalidProjectNameException","CannotCreateProjectsWithDisableProcessException","ProjectNameNotRecognizedException"].findIndex((e=>e===a));this._actionsHub.projectCreationFailed.invoke({projectName:e,navigationUrl:"",projectCreationOperationId:o,creationStatus:{value:2,message:t.message,detailedMessage:s},statusMessage:{message:t.message,statusMessageType:2,showGoBackCta:r,showTryAgainCta:!r,operationLogsLink:i}})}_invokeProjectCreationSucceededAction(e,t,s){this._actionsHub.projectCreationSucceeded.invoke({projectName:e,navigationUrl:t,creationStatus:{value:1,message:s},statusMessage:{message:s,statusMessageType:1,showGoBackCta:!1,showTryAgainCta:!1}})}}}("ActionCreator"),function(e){U=t[e]={};class s extends h.VssComponent{constructor(){super(...arguments),this._advancedOptionsContainerId=(0,u.getId)("advanced-options-container-id"),this._onSelectedOptionChanged=(e,t)=>{e===s.VERSION_CONTROL_SELECTOR_KEY?this.props.onVersionControlComboOptionChanged(t):e===s.PROCESS_TEMPLATE_SELECTOR_KEY&&this.props.onProcessTemplateComboOptionChanged(t)},this._getInitialOptions=()=>({[s.VERSION_CONTROL_SELECTOR_KEY]:this.props.currentVersionControlType,[s.PROCESS_TEMPLATE_SELECTOR_KEY]:this.props.currentProcessTemplate})}render(){const{showAdvancedOptions:e,disabled:t,onAdvancedOptionClick:i,currentVersionControlType:o,currentProcessTemplate:a,onVersionControlComboOptionChanged:r,onProcessTemplateComboOptionChanged:n}=this.props;return this.context.pageContext.getService("IVssLayoutManager").getComponentsForRegion(s.REGION_NAME).length>0?d.createElement("div",{className:"advanced-options-container"},d.createElement(m.Button,{className:"advanced-options-toggle-button",iconProps:{iconName:e?"ChevronUp":"ChevronDown",className:"chevron-icon"},text:F.CreateProjectAdvancedOptionsText,"aria-expanded":e,"aria-controls":this._advancedOptionsContainerId,disabled:t,onClick:i}),d.createElement("div",{id:this._advancedOptionsContainerId},e&&d.createElement(h.RegionComponent,{className:"advanced-options-region flex",componentRegion:s.REGION_NAME,childComponentProperties:{className:"options-selector",onSelectedOptionChanged:this._onSelectedOptionChanged,initialOptions:this._getInitialOptions(),disabled:t}}))):null}}t[e].AdvancedOptions=s,s.REGION_NAME="createProjectAdvancedOptionsRegion",s.VERSION_CONTROL_SELECTOR_KEY="versionControlSelector",s.PROCESS_TEMPLATE_SELECTOR_KEY="processTemplateSelector"}("ComponentsAdvancedOptions"),function(e){W=t[e]={};t[e].CodeOfConductStatement=e=>d.createElement("div",{className:"code-of-conduct-statement"},d.createElement(g.FormatComponent,{format:F.CreateProjectCodeOfConductStatement},d.createElement("span",null,C.BrandWithProductName),d.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:F.CreateProjectCodeOfConductLink},F.CreateProjectCodeOfConductText)))}("ComponentsCodeOfConductStatement"),function(e){G=t[e]={};class s extends h.VssComponent{constructor(e,t){super(e,t),this._collectionNameTextFieldId=(0,u.getId)("collection-name-textfield")}render(){const{hostName:e}=this.props;return d.createElement("div",{className:"collection-name-container"},d.createElement(j.Label,{htmlFor:this._collectionNameTextFieldId},F.CreateProjectCollectionNameContainerHeader),d.createElement(P.TextField,{className:"text-input",id:this._collectionNameTextFieldId,value:e,disabled:!0}))}}t[e].CollectionNameTextField=s}("ComponentsCollectionNameTextField"),function(e){z=t[e]={};class s extends h.VssComponent{render(){if(3===this.props.pageStatus)return null;const e=!1===this.props.isPanelView,t=1===this.props.statusMessage;return e&&t?d.createElement(S.Spinner,{className:"spinner-message",label:F.CreatingNewProjectMessage}):d.createElement(_.ButtonGroup,{className:"create-project-actions-container flex flex-noshrink"},this.props.onCancelButtonClick&&d.createElement("span",{className:"cancel-action"},d.createElement(m.Button,{disabled:this.props.isCancelButtonDisabled,text:F.CreateProjectCancelButtonText,onClick:this.props.onCancelButtonClick})),d.createElement("span",{className:"create-action"},d.createElement(m.Button,{className:"create-button",primary:!0,disabled:this.props.isCreateButtonDisabled,text:this.props.onCancelButtonClick?F.CreateProjectWithCancelCTAButtonText:F.CreateProjectCTAButtonText,iconProps:this.props.onCancelButtonClick?void 0:{iconName:"Add"},onClick:this.props.onCreateButtonClick})))}}t[e].FooterContent=s}("ComponentsFooterContent"),function(e){K=t[e]={};class s extends h.VssComponent{constructor(e,t){super(e,t),this._projectDescriptionText=new v.ObservableValue(""),this.onValueChanged=(e,t)=>{this._projectDescriptionText.value=t,this.props.onChanged&&this.props.onChanged(t)},this._projectDescriptionTextFieldId=(0,u.getId)("project-description-textfield"),this._projectDescriptionAriaDescriptionId=(0,u.getId)("project-description-aria-description"),this._projectDescriptionText.value=this.props.value}render(){return d.createElement("div",{className:"project-description-container"},d.createElement(y.FormItem,{label:F.CreateProjectDescriptionContainerHeader},d.createElement(b.TextField,{inputClassName:"description-textarea-input",key:this._projectDescriptionTextFieldId,ariaDescribedBy:this._projectDescriptionAriaDescriptionId,multiline:!0,onKeyDown:this.props.onProjectDescriptionTextFieldKeyDown,autoAdjustHeight:!0,onChange:this.onValueChanged,disabled:this.props.disabled,maxLength:I.ProjectParameterConstants.MaxProjectDescriptionLength,value:this._projectDescriptionText})),d.createElement("div",{className:"hidden",id:this._projectDescriptionAriaDescriptionId},F.ProjectDecriptionTextFieldAriaDescription))}}t[e].ProjectDescriptionTextField=s}("ComponentsProjectDescriptionTextField"),function(e){q=t[e]={};class s extends h.VssComponent{constructor(e,t){super(e,t)}render(){const{status:e}=this.props,t=e.value,s=e.message;let i;return i=2==t?"Error":"Warning","Warning"!==i||s&&0!==s.trim().length?d.createElement("div",{className:"project-limit-warning-container margin-16"},d.createElement(f.MessageBar,{severity:i},s)):null}}t[e].ProjectLimitPanel=s}("ComponentsProjectLimitPanel"),function(e){Y=t[e]={};class s extends h.VssComponent{constructor(e,t){super(e,t),this._textField=d.createRef(),this.select=()=>{this._textField.current&&this._textField.current.select()},this._projectNameTextFieldId=(0,u.getId)("project-name-textfield"),this._projectNameAriaDescriptionId=(0,u.getId)("project-name-aria-description")}render(){return d.createElement("div",{className:"project-name-container"},d.createElement(y.FormItem,{required:!0,message:this.props.errorMessage,error:""!==this.props.errorMessage,label:F.CreateProjectNameContainerHeader},d.createElement(b.TextField,{autoFocus:!0,key:this._projectNameTextFieldId,ariaDescribedBy:this._projectNameAriaDescriptionId,className:"project-name-textfield",inputClassName:"project-name-textfield-input",onKeyDown:this.props.onProjectNameTextFieldKeyDown,disabled:this.props.disabled,maxLength:I.ProjectParameterConstants.MaxProjectNameLength,value:this.props.value,onChange:(e,t)=>this.props.onInputChange(t),ref:this._textField})),d.createElement("div",{className:"hidden",id:this._projectNameAriaDescriptionId},F.CreateProjectNameAriaDescription))}focus(){this._textField.current&&this._textField.current.focus()}}t[e].ProjectNameTextField=s}("ComponentsProjectNameTextField"),function(e){X=t[e]={};class s extends h.VssComponent{constructor(){super(...arguments),this._onProjectVisibilityChanged=e=>{let t=-1;const{projectVisibilityOptions:s}=this.props;for(let i=0;i<s.length;i++){if(s[i].id===e){t=i;break}}t>-1&&this.props.onProjectVisibilityChanged(t)}}render(){return d.createElement("div",{className:"project-visibility-container"},d.createElement(x.RadioButtonGroup,{onSelect:this._onProjectVisibilityChanged,selectedButtonId:this.props.currentProjectVisibilityOption.id,text:F.CreateProjectProjectVisibilitySectionHeader},this._getProjectVisibilityOptions()))}_getProjectVisibilityOptions(){return(this.props.projectVisibilityOptions||[]).map((e=>d.createElement(x.RadioButton,{className:"visibility-button flex-row",key:e.id,id:e.id,disabled:e.isDisabled},this._getVisibilityContent(e))))}_getVisibilityContent(e){const{text:t,iconName:s}=this._getOptionLabelInfo(e.id);return d.createElement("div",{className:"visibility-button-content flex-column"},d.createElement(T.Icon,{className:(0,N.css)("visibility-option-icon",!e.isDisabled&&"enabled",e.isDisabled&&"disabled"),iconName:s,size:"medium"}),d.createElement("div",{className:"visibility-option-text"},this._getTitleText(e,t,e.isDisabled),this._getDesctiptionText(e.id)))}_getOptionLabelInfo(e){switch(e){case I.ProjectVisibilityConstants.TeamMembers:return{text:F.CreateProjectPrivateVisibilityText,iconName:"Lock"};case I.ProjectVisibilityConstants.EveryoneInTenant:return{text:F.CreateProjectOrganizationVisibilityText,iconName:"CityNext"};case I.ProjectVisibilityConstants.Everyone:return{text:F.CreateProjectPublicVisibilityText,iconName:"Globe"};default:throw new Error(i.format(F.CreateProjectInvalidVisibilityValue,e))}}_getDesctiptionText(e){let t;switch(e){case I.ProjectVisibilityConstants.Everyone:t=d.createElement(g.FormatComponent,{format:F.CreateProjectPublicVisibilityOptionDescription});break;case I.ProjectVisibilityConstants.EveryoneInTenant:t=F.CreateProjectOrganizationVisibilityOptionDescription;break;case I.ProjectVisibilityConstants.TeamMembers:t=F.CreateProjectPrivateVisibilityOptionDescription;break;default:throw new Error(i.format(F.CreateProjectInvalidVisibilityValue,e))}return t}_getTitleText(e,t,s){return d.createElement("div",{id:e.id,className:(0,N.css)("visibility-option-title",!s&&"enabled",s&&"disabled")},t)}}t[e].ProjectVisibilityOptions=s}("ComponentsProjectVisibilityOptions"),function(e){$=t[e]={};class s extends h.VssComponent{render(){const{statusMessage:e}=this.props,t=e.statusMessageType,s=1===t;return 0!==t?d.createElement("div",{className:"status-message-container"},!s&&d.createElement(V.MessageCard,{severity:"Error"},e.message)):null}}t[e].StatusMessageCard=s}("ComponentsStatusMessageCard"),function(e){J=t[e]={};t[e].StoreListener=class{constructor(){this._disposeStoreListeners=[]}addChangedListener(e,t){e.addChangedListener(t),this._disposeStoreListeners&&this._disposeStoreListeners.push((()=>e.removeChangedListener(t)))}addChangedListenerForMultipleStores(e,t){e.forEach((e=>{e.addChangedListener(t),this._disposeStoreListeners&&this._disposeStoreListeners.push((()=>e.removeChangedListener(t)))}))}addListener(e,t){e.addListener(t),this._disposeStoreListeners&&this._disposeStoreListeners.push((()=>e.removeListener(t)))}disposeAllListeners(){this._disposeStoreListeners&&(this._disposeStoreListeners.map((e=>e())),this._disposeStoreListeners=void 0)}}}("SharedStoreListener"),function(e){Q=t[e]={};class s extends E.Store{constructor(e,t,s,i,o){super("createProjectStoreChanged"),this._source=e,this._versionControlType=t,this._processTemplate=s,this._projectVisibility=i,this._featureIds=o,this.onProjectCreationMetadataLoadStatusChanged=e=>{this._state.pageStatus.value=e.pageStatus.value,this._state.pageStatus.message=e.pageStatus.message,this._state.statusMessage=e.statusMessage,1===e.pageStatus.value&&(e.projectCreationMetadata&&(this._state.projectCreationMetadata=e.projectCreationMetadata,this._state.projectParamsState.currentProcessTemplateId=e.projectCreationMetadata.defaultProcessTemplate.typeId,this._state.projectParamsState.currentProcessTemplateName=e.projectCreationMetadata.defaultProcessTemplate.name,this._state.projectParamsState.currentVersionControlType=e.projectCreationMetadata.defaultVersionControlType.id,!this._featureIds&&e.projectCreationMetadata.defaultFeatureIds&&(this._state.featureIds=e.projectCreationMetadata.defaultFeatureIds),!this._projectVisibility&&e.projectCreationMetadata.defaultVisibility&&(this._projectVisibility=e.projectCreationMetadata.defaultVisibility)),(this._versionControlType||this._processTemplate)&&(this._state.showAdvancedOptions=!0,this._versionControlType&&(this._state.projectParamsState.currentVersionControlType=this._versionControlType),this._processTemplate&&(this._state.projectParamsState.currentProcessTemplateId="",this._state.projectParamsState.currentProcessTemplateName=this._processTemplate)),this._populateProjectVisibilityOptions()),this.emitChanged()},this.updateExistingProjectNames=e=>{e.forEach((e=>{this.state.existingProjectNames[e.toLowerCase()]=!0})),this.emitChanged()},this.onProjectCreationStatusChanged=e=>{this._state.navigationUrl=e.navigationUrl,this._state.statusMessage=e.statusMessage,this._state.creationStatus.value=e.creationStatus.value,this._state.creationStatus.message=e.creationStatus.message,this._state.creationStatus.detailedMessage=e.creationStatus.detailedMessage,this._state.creationStatus.creationOperationId=e.projectCreationOperationId,this.emitChanged()},this.onProjectNameValidationStatusChanged=e=>{this._state.projectNameState.name=e.projectName;const t=this._state.projectNameState.status;this._state.projectNameState.name?(t.value=e.status.value,t.message=e.status.message):(t.value=0,t.message=""),this._state.creationStatus.value=0,this._state.creationStatus.message="",this._state.projectNameState.status=t,this.emitChanged()},this.onProjectLimitCheckStatusChanged=e=>{this._state.projectLimitState.isBelowLimit=e.isBelowLimit,this._state.projectLimitState.isBelowWarning=e.isBelowWarning,this._state.projectLimitState.status.value=e.status.value,this._state.projectLimitState.status.message=e.status.message,this.emitChanged()},this.onProjectDescriptionChanged=e=>{this._state.projectParamsState.projectDescription=e,this.emitChanged()},this.onVersionControlTypeChanged=e=>{this._state.projectParamsState.currentVersionControlType=e,this.emitChanged()},this.onProjectVisibilityOptionChanged=e=>{this._state.projectParamsState.currentProjectVisibilityOption=this._state.projectCreationMetadata.projectVisibilityOptions[e],this.emitChanged()},this.onProcessTemplateChanged=e=>{this._state.projectParamsState.currentProcessTemplateId=e,this.emitChanged()},this.onStatusMessageDismissed=e=>{this._state.creationStatus.value=0,this._state.creationStatus.message="",this._state.pageStatus.value=0,this._state.pageStatus.message="",this._hideStatusMessage(),this.emitChanged()},this.onAdvancedOptionVisibilityToggle=e=>{this._state.showAdvancedOptions=!this._state.showAdvancedOptions,this.emitChanged()},this._state={navigationUrl:"",projectCreationMetadata:{canUserCreateProject:void 0,defaultVersionControlType:{},projectVisibilityOptions:[],defaultProcessTemplate:{},isReportingConfigured:!1},existingProjectNames:{},featureIds:this._featureIds,projectNameState:{name:"",status:{statusType:2,value:0,message:""}},projectParamsState:{projectDescription:"",projectVisibilityOptions:[],currentProcessTemplateId:"",currentProcessTemplateName:"",currentVersionControlType:"",currentProjectVisibilityOption:{}},projectLimitState:{isBelowLimit:!1,isBelowWarning:!1,status:{statusType:3,value:0,message:""}},creationStatus:{statusType:1,value:0,message:"",detailedMessage:"",creationOperationId:""},pageStatus:{statusType:0,value:0,message:""},source:this._source,showAdvancedOptions:!1,statusMessage:{message:"",statusMessageType:0,showTryAgainCta:!1,showGoBackCta:!1}}}get state(){return this._state}_hideStatusMessage(){this._state.statusMessage.message="",this._state.statusMessage.statusMessageType=0,this._state.statusMessage.showTryAgainCta=!1}_populateProjectVisibilityOptions(){const e=[],t=this._state.projectCreationMetadata.projectVisibilityOptions;if(t&&t.length>0){let s=null,i=t[0];t.forEach((t=>{e.push({text:t.name}),this._projectVisibility&&t.id===this._projectVisibility&&!t.isDisabled?s=t:t.isDefault&&(i=t)})),this._state.projectParamsState.currentProjectVisibilityOption=s||i}e.length<2?this._state.projectParamsState.projectVisibilityOptions=[]:this._state.projectParamsState.projectVisibilityOptions=e}}t[e].Store=s}("Store"),function(e){Z=t[e]={};t[e].StoresHub=class{constructor(e,t,s,i,o,a){this._actionsHub=e,this._source=t,this._versionControlType=s,this._processTemplate=i,this._projectVisibility=o,this._featureIds=a,this._storeListener=new J.StoreListener,this._storeListener.addListener(this._actionsHub.projectCreationMetadataLoadStarted,this.store.onProjectCreationMetadataLoadStatusChanged),this._storeListener.addListener(this._actionsHub.projectCreationMetadataLoadSucceeded,this.store.onProjectCreationMetadataLoadStatusChanged),this._storeListener.addListener(this._actionsHub.projectCreationMetadataLoadFailed,this.store.onProjectCreationMetadataLoadStatusChanged),this._storeListener.addListener(this._actionsHub.existingProjectNamesFetched,this.store.updateExistingProjectNames),this._storeListener.addListener(this._actionsHub.projectCreationSucceeded,this.store.onProjectCreationStatusChanged),this._storeListener.addListener(this._actionsHub.projectCreationFailed,this.store.onProjectCreationStatusChanged),this._storeListener.addListener(this._actionsHub.projectCreationStarted,this.store.onProjectCreationStatusChanged),this._storeListener.addListener(this._actionsHub.projectNameValidationSucceeded,this.store.onProjectNameValidationStatusChanged),this._storeListener.addListener(this._actionsHub.projectNameValidationFailed,this.store.onProjectNameValidationStatusChanged),this._storeListener.addListener(this._actionsHub.projectNameValidationReset,this.store.onProjectNameValidationStatusChanged),this._storeListener.addListener(this._actionsHub.projectLimitCheckSucceeded,this.store.onProjectLimitCheckStatusChanged),this._storeListener.addListener(this._actionsHub.projectLimitCheckFailed,this.store.onProjectLimitCheckStatusChanged),this._storeListener.addListener(this._actionsHub.projectDescriptionChanged,this.store.onProjectDescriptionChanged),this._storeListener.addListener(this._actionsHub.versionControlChanged,this.store.onVersionControlTypeChanged),this._storeListener.addListener(this._actionsHub.projectVisibilityChanged,this.store.onProjectVisibilityOptionChanged),this._storeListener.addListener(this._actionsHub.processTemplateChanged,this.store.onProcessTemplateChanged),this._storeListener.addListener(this._actionsHub.statusMessageDismissed,this.store.onStatusMessageDismissed),this._storeListener.addListener(this._actionsHub.advancedOptionVisibilityToggled,this.store.onAdvancedOptionVisibilityToggle)}get store(){return this._store||(this._store=new Q.Store(this._source,this._versionControlType,this._processTemplate,this._projectVisibility,this._featureIds)),this._store}dispose(){this._storeListener&&this._storeListener.disposeAllListeners()}}}("StoresHub"),function(e){ee=t[e]={};class s extends h.VssComponent{constructor(e,t){super(e,t),this._projectNameTextField=d.createRef(),this._shouldSetFocus=!0,this._onStatusMessageCtaClick=()=>{const e=this.state.statusMessage,t=e.statusMessageType,s=this.state.creationStatus.value;e.showGoBackCta?(this._actionCreator.dismissStatusMessage(),this._projectNameTextField.current&&null!==this._projectNameTextField&&this._projectNameTextField.current.focus()):e.showTryAgainCta&&2===s?this._onCreateButtonClick():e.showTryAgainCta&&3===t&&this._actionCreator.reloadPanel()},this._toggleAdvancedOptionsVisibility=()=>{this._actionCreator.toggleAdvancedOptionsVisibility();this.context.pageContext.getService("IVssTelemetryService").publishEvent(I.Constants.Area,"CreateProjectPanel.AdvancedOptionsClicked",{advancedOptionsShownOnClick:!this.state.showAdvancedOptions})},this._onStoreChanged=()=>{this.setState(this._storesHub.store.state)},this._onProjectNameTextFieldKeyDown=e=>{13===e.keyCode&&!e.shiftKey&&this._canEnableCreateProjectCta()&&this._onCreateButtonClick()},this._onProjectDescriptionTextFieldKeyDown=e=>{13===e.keyCode&&e.ctrlKey&&this._canEnableCreateProjectCta()&&this._onCreateButtonClick()},this._onCreateButtonClick=()=>{this._createProject();this.context.pageContext.getService("IVssTelemetryService").publishEvent(I.Constants.Area,"CreateProjectPanel.CreateButtonClicked",{source:this.state.source,acquisitionId:this.props.acquisitionId,product:this.props.product,featureIds:this.state.featureIds,projectName:this.state.projectNameState.name,isPreCreatedProject:!!this.props.preCreatedProjectId})},this._onCancelButtonClick=()=>{this._cancelCreateProject("CancelButton")},this._cancelCreateProject=e=>{const t=this.state.creationStatus.value,s=3===t||1===t;this.context.pageContext.getService("IVssTelemetryService").publishEvent(I.Constants.Area,"CreateProjectPanel.CancelButtonClicked",{source:this.state.source,ctaSource:e,waitingForProjectCreation:s}),this.props.onCancel&&this.props.onCancel()},this._onInputChange=e=>(this._canEnableFormElement()&&(e?this._actionCreator.validateAndUpdateProjectName(e,this.state.existingProjectNames):0!==this.state.projectNameState.status.value&&this._actionCreator.resetProjectNameValidation()),"");const s=this.context.pageContext.getService("IVssPageService").getData();this._isHosted=!!s&&s.isHosted,this._hostName=s?s.hostName:"";const i=e.actionsHub?e.actionsHub:new A.ActionsHub;this._storesHub=new Z.StoresHub(i,e.invokingSource,e.versionControlType,e.processTemplate,e.projectVisibility,e.defaultFeatureIds),this._actionCreator=e.actionCreator?e.actionCreator:new H.ActionCreator(i,this.context.pageContext,void 0,void 0,void 0,this.props.onCreateProjectComplete),this._actionCreator.fetchProjectCreationMetadata(),this._actionCreator.fetchExistingProjectNames(),this._actionCreator.checkProjectLimit(),this.state=this._storesHub.store.state}render(){const e=!this._canEnableFormElement(),t=this.props.isLightWeightView,{projectNameState:s,projectParamsState:i,statusMessage:o,pageStatus:a,creationStatus:r,projectCreationMetadata:n,projectLimitState:c,showAdvancedOptions:l}=this.state,u=3===a.value,m=this._showPolicyMessage(),C=n.isReportingConfigured,j=this._showProjectVisibilityOptions()&&i.currentProjectVisibilityOption.id===I.ProjectVisibilityConstants.Everyone,P=this._showProjectlimitMessage();return u?d.createElement(S.Spinner,{className:"flex-grow flex-center",label:F.LoadingText}):d.createElement(L.Fabric,{className:(0,h.css)("create-project-component flex-column",this.props.className)},d.createElement("fieldset",{className:"create-project-component-fieldset"},d.createElement("div",{"aria-live":"assertive","aria-atomic":"true"},d.createElement($.StatusMessageCard,{statusMessage:o})),!this._isHosted&&d.createElement(G.CollectionNameTextField,{hostName:this._hostName}),P&&d.createElement(q.ProjectLimitPanel,{status:c.status}),d.createElement(Y.ProjectNameTextField,{value:s.name,projectNameStatus:s.status.value,projectCreationStatus:r.value,disabled:e,onInputChange:this._onInputChange,onProjectNameTextFieldKeyDown:this._onProjectNameTextFieldKeyDown,errorMessage:s.status.message,ref:this._projectNameTextField}),!t&&d.createElement(K.ProjectDescriptionTextField,{onProjectDescriptionTextFieldKeyDown:this._onProjectDescriptionTextFieldKeyDown,onChanged:this._actionCreator.updateProjectDescription,value:i.projectDescription,disabled:e}),this._showProjectVisibilityOptions()&&d.createElement(X.ProjectVisibilityOptions,{disabled:e,projectVisibilityOptions:n.projectVisibilityOptions,currentProjectVisibilityOption:i.currentProjectVisibilityOption,onProjectVisibilityChanged:this._actionCreator.updateProjectVisibilityOption}),m&&d.createElement("div",{className:"form-section"},d.createElement(g.FormatComponent,{format:F.CreateProjectPolicyMessage},d.createElement(w.Link,{className:"link-text",href:(0,p.routeUrl)(this.context.pageContext,"ms.vss-admin-web.collection-admin-hub-route",{adminPivot:"organizationPolicy"})},F.CreateProjectPolicyLinkText))),j&&d.createElement(W.CodeOfConductStatement,{pageContext:this.context.pageContext}),C&&d.createElement("div",{className:"form-section flex-row"},d.createElement(T.Icon,{className:"reporting-warning-icon fontSizeM",iconName:"Warning"}),d.createElement(g.FormatComponent,{format:F.ReportingServiceWarningMessage},d.createElement(w.Link,{className:"link-text",target:"_blank",rel:"noopener noreferrer",href:F.ReportingServiceWarningUrl},F.FindOutText))),!t&&d.createElement(U.AdvancedOptions,{showAdvancedOptions:l,disabled:e,onAdvancedOptionClick:this._toggleAdvancedOptionsVisibility,currentVersionControlType:i.currentVersionControlType,currentProcessTemplate:i.currentProcessTemplateName,onVersionControlComboOptionChanged:this._actionCreator.updateVersionControlType,onProcessTemplateComboOptionChanged:this._actionCreator.updateProcessTemplate})),d.createElement(z.FooterContent,{pageStatus:this.state.pageStatus.value,statusMessage:this.state.statusMessage.statusMessageType,isPanelView:this.props.isPanelView,onCreateButtonClick:this._onCreateButtonClick,onCancelButtonClick:this.props.onCancel?this._onCancelButtonClick:void 0,isCreateButtonDisabled:!this._canEnableCreateProjectCta(),isCancelButtonDisabled:!this._canEnableFormElement()}))}componentDidUpdate(e,t){if(super.componentDidUpdate(e,t),this.state.navigationUrl)return void(window.location.href=this.state.navigationUrl);this._shouldSetFocus&&this.state.projectCreationMetadata.canUserCreateProject&&this._projectNameTextField&&(this._shouldSetFocus=!1,this._projectNameTextField.current&&this._projectNameTextField.current.focus());const s=this.state.pageStatus.value;if(!this._isScenarioRecorded&&3!==s&&0!==s&&this.props.onScenarioComplete){const e=2===s?"Failed":"Succeeded";this.props.onScenarioComplete(e),this._isScenarioRecorded=!0}}componentDidMount(){super.componentDidMount(),this.storeListener.addChangedListener(this._storesHub.store,this._onStoreChanged)}componentWillUnmount(){super.componentWillUnmount(),this._storeListener&&this._storeListener.disposeAllListeners(),this._storesHub&&this._storesHub.dispose()}_createProject(){const e=this.state.projectNameState,t=this.state.projectParamsState;let s="";this._projectNameTextField.current&&this._projectNameTextField.current.props.value&&(s=this._projectNameTextField.current.props.value.toString());const i={product:this.props.product,featureIds:this.state.featureIds,projectName:e.name.trim(),projectDescription:t.projectDescription.trim(),processTemplateTypeId:this._shouldUseDefaultTemplate()?I.Constants.DefafultProcessTemplate:t.currentProcessTemplateId,versionControlOption:t.currentVersionControlType,projectVisibilityOption:null!=t.currentProjectVisibilityOption?t.currentProjectVisibilityOption.id:void 0};this._actionCreator.createProject(i,s,this.state.existingProjectNames,this.props.preCreatedProjectId,this.props.skipRedirectToDetails)}_shouldUseDefaultTemplate(){return(0,l.isFeatureFlagEnabled)(this.context.pageContext,"Azure.DevOps.Acquisition.EnableDefaultProcessForProjectCreate")&&!0===this.props.isLightWeightView}_showProjectVisibilityOptions(){return null!=this.state.projectParamsState.projectVisibilityOptions&&this.state.projectParamsState.projectVisibilityOptions.length>0}_showPolicyMessage(){return this.state.projectCreationMetadata&&this.state.projectCreationMetadata.projectVisibilityOptions&&this.state.projectCreationMetadata.projectVisibilityOptions.filter((e=>e.id===I.ProjectVisibilityConstants.Everyone&&e.isDisabled)).length>0}_canEnableFormElement(){const e=1===this.state.statusMessage.statusMessageType;return null!=this.state.projectCreationMetadata&&!e}_canEnableCreateProjectCta(){return!(!this._canEnableFormElement()||!this.state.projectNameState.name||1!==this.state.projectNameState.status.value||1!==this.state.projectLimitState.status.value&&this._actionCreator.getProjectLimitFeatureFlag())}_showProjectlimitMessage(){return!(this._actionCreator.getProjectLimitFeatureFlag()||this.state.projectLimitState.isBelowWarning&&this.state.projectLimitState.isBelowLimit)}get storeListener(){return this._storeListener||(this._storeListener=new J.StoreListener),this._storeListener}}t[e].CreateProjectComponent=s,h.VssComponent.register("createProjectComponent",s)}("ComponentsCreateProjectComponent"),function(e){t.ComponentsCreateProjectPanel={};const s="CreateProjectPanel.Invoked";class i extends h.VssComponent{constructor(e,t){super(e,t),this._onDismissButtonClick=()=>{this._cancelCreateProject("DismissButton")},this._cancelCreateProject=e=>{const t=this.state.creationStatus.value,s=3===t||1===t;this.context.pageContext.getService("IVssTelemetryService").publishEvent(I.Constants.Area,"CreateProjectPanel.CancelButtonClicked",{source:this.state.source,ctaSource:e,waitingForProjectCreation:s}),this.props.onPanelDismiss&&this.props.onPanelDismiss()},this._onStoreChanged=()=>{this.setState(this._storesHub.store.state)},this._onScenarioComplete=e=>{this._performanceService.endScenario(I.Constants.Area,s,!1,void 0,{status:e});this.context.pageContext.getService("IVssTelemetryService").publishEvent(I.Constants.Area,"CreateProjectPanel.Invoked",{source:this.props.invokingSource,pageDataStatus:e})},this._performanceService=t.pageContext.getService("IVssPerformanceService"),this._performanceService.startScenario(s,!1),this._actionsHub=new A.ActionsHub,this._storesHub=new Z.StoresHub(this._actionsHub,e.invokingSource,e.versionControlType,e.processTemplate,e.projectVisibility,e.defaultFeatureIds),this.state=this._storesHub.store.state}render(){const e=this.state.creationStatus,t=3===e.value||1===e.value;return this.props.showPanel?d.createElement(O.Panel,{className:"create-project-panel",onDismiss:this._onDismissButtonClick,titleProps:{text:F.CreateProjectFormHeader},size:2,overlayContent:t?d.createElement(S.Spinner,{label:e.message}):null},d.createElement(ee.CreateProjectComponent,{className:"panel-view flex-grow",onCancel:this.props.onPanelDismiss,onScenarioComplete:this._onScenarioComplete,invokingSource:this.props.invokingSource,processTemplate:this.props.processTemplate,projectVisibility:this.props.projectVisibility,versionControlType:this.props.versionControlType,acquisitionId:this.props.acquisitionId,isLightWeightView:this.props.isLightWeightView,defaultFeatureIds:this.props.defaultFeatureIds,actionsHub:this._actionsHub,storesHub:this._storesHub,skipRedirectToDetails:this.props.skipRedirectToDetails,onCreateProjectComplete:this.props.onCreateProjectComplete})):null}componentDidMount(){super.componentDidMount(),this._storesHub.store.addChangedListener(this._onStoreChanged)}componentWillUnmount(){super.componentWillUnmount(),this._storesHub.store.removeChangedListener(this._onStoreChanged)}}i.componentType="createProjectPanel",h.VssComponent.register(i.componentType,i)}(),function(e){t[e]={};class s extends h.VssComponent{render(){const{statusMessage:e,onCtaClick:t}=this.props,s=e.statusMessageType,i=1===s,o=0!==s,a=e.showGoBackCta||e.showTryAgainCta,r=e.showGoBackCta?F.GoBackButtonText:F.TryAgainButtonText;return o?d.createElement(M.Overlay,{className:"status-message-overlay flex flex-center justify-center"},d.createElement("div",null,d.createElement("div",{className:"status-message-overlay-container flex flex-column"},i?d.createElement(d.Fragment,null,d.createElement(S.Spinner,{size:"large",className:"status-message-spinner"}),d.createElement("span",{className:"status-message fontSizeML fontWeightSemiBold"},e.message)):d.createElement(d.Fragment,null,d.createElement(T.Icon,{className:"status-message-icon fontSizeXL",iconName:"Warning"}),d.createElement("span",{className:"status-message status-message-text fontSizeML fontWeightSemiBold"},F.GenericErrorMessage),d.createElement("span",{className:"status-sub-message fontSizeML"},e.message)),a&&d.createElement("div",null,d.createElement(m.Button,{primary:!0,autoFocus:!0,className:"status-message-cta",text:r,onClick:t}))))):null}}t[e].StatusMessageOverlay=s}("ComponentsStatusMessageOverlay")}),["Resources","Models","ActionsHub","Constants","ProjectNameValidator","Sources/ApiSource","Sources/DataProviderSource","Generated/RestClient/Operations","Sources/OperationResultSource","ActionCreator","Components/AdvancedOptions","Components/CodeOfConductStatement","Components/CollectionNameTextField","Components/FooterContent","Components/ProjectDescriptionTextField","Components/ProjectLimitPanel","Components/ProjectNameTextField","Components/ProjectVisibilityOptions","Components/StatusMessageCard","Shared/StoreListener","Store","StoresHub","Components/CreateProjectComponent","Components/CreateProjectPanel","Components/StatusMessageOverlay"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-tfs-web.create-project-content"}}));